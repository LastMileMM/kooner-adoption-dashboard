   <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kooner Adoption Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
    <style>
        :root {
            --bg-dark: #0a0a0f;
            --bg-card: #12121a;
            --bg-card-hover: #1a1a25;
            --accent-green: #00ff88;
            --accent-red: #ff4757;
            --accent-orange: #ffa502;
            --accent-blue: #3742fa;
            --accent-purple: #a855f7;
            --accent-cyan: #00d4ff;
            --text-primary: #ffffff;
            --text-secondary: #8b8b9a;
            --text-muted: #4a4a5a;
            --border-color: #2a2a3a;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Space Grotesk', sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
        }

        .bg-grid {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-image: 
                linear-gradient(rgba(55, 66, 250, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(55, 66, 250, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: 0;
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1600px;
            margin: 0 auto;
            padding: 24px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 32px;
            padding-bottom: 24px;
            border-bottom: 1px solid var(--border-color);
        }

        .header-left h1 {
            font-size: 2.5rem;
            font-weight: 700;
            letter-spacing: -0.02em;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #fff 0%, #8b8b9a 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header-left .subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .target-badge {
            background: linear-gradient(135deg, var(--accent-green), #00cc6a);
            color: #000;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
        }

        .header-right { text-align: right; }
        .last-updated { color: var(--text-muted); font-size: 0.85rem; font-family: 'JetBrains Mono', monospace; }
        .data-period { color: var(--text-secondary); font-size: 0.9rem; margin-top: 4px; }

        .nav-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            background: var(--bg-card);
            padding: 8px;
            border-radius: 12px;
            width: fit-content;
        }

        .nav-tab {
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            background: transparent;
            border: none;
            color: var(--text-secondary);
        }

        .nav-tab:hover { background: var(--bg-card-hover); color: var(--text-primary); }
        .nav-tab.active { background: var(--accent-blue); color: white; }

        .tab-content { display: none; }
        .tab-content.active { display: block; }

        .kpi-row {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 16px;
            margin-bottom: 32px;
        }

        .kpi-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 24px;
            position: relative;
            overflow: hidden;
        }

        .kpi-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 3px;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple));
        }

        .kpi-card.success::before { background: linear-gradient(90deg, var(--accent-green), #00cc6a); }
        .kpi-card.warning::before { background: linear-gradient(90deg, var(--accent-orange), #ff6b00); }
        .kpi-card.danger::before { background: linear-gradient(90deg, var(--accent-red), #ff2f43); }

        .kpi-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 8px;
        }

        .kpi-value {
            font-size: 2.2rem;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
            line-height: 1;
        }

        .kpi-value.green { color: var(--accent-green); }
        .kpi-value.red { color: var(--accent-red); }
        .kpi-value.orange { color: var(--accent-orange); }
        .kpi-subtext { font-size: 0.8rem; color: var(--text-muted); margin-top: 8px; }

        .kpi-trend {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 0.85rem;
            margin-top: 8px;
            padding: 2px 8px;
            border-radius: 4px;
        }

        .kpi-trend.up { color: var(--accent-green); background: rgba(0, 255, 136, 0.1); }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-bottom: 32px;
        }

        .card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 24px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-title { font-size: 1.1rem; font-weight: 600; }

        .card-badge {
            font-size: 0.75rem;
            padding: 4px 10px;
            border-radius: 12px;
            font-family: 'JetBrains Mono', monospace;
        }

        .badge-stations { background: rgba(55, 66, 250, 0.2); color: var(--accent-blue); }
        .badge-dsps { background: rgba(168, 85, 247, 0.2); color: var(--accent-purple); }
        .badge-trends { background: rgba(0, 212, 255, 0.2); color: var(--accent-cyan); }

        .data-table { width: 100%; border-collapse: collapse; }

        .data-table th {
            text-align: left;
            padding: 12px 8px;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
            border-bottom: 1px solid var(--border-color);
            background: var(--bg-card);
        }

        .data-table td {
            padding: 14px 8px;
            font-size: 0.9rem;
            border-bottom: 1px solid var(--border-color);
        }

        .data-table tr:hover td { background: rgba(55, 66, 250, 0.05); }
        .station-name { font-weight: 600; font-family: 'JetBrains Mono', monospace; }

        .status-pill {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .status-pill.on-target { background: rgba(0, 255, 136, 0.15); color: var(--accent-green); }
        .status-pill.below-target { background: rgba(255, 71, 87, 0.15); color: var(--accent-red); }
        .status-dot { width: 6px; height: 6px; border-radius: 50%; background: currentColor; }

        .priority-pill {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .priority-critical { background: rgba(255, 71, 87, 0.2); color: var(--accent-red); }
        .priority-high { background: rgba(255, 165, 2, 0.2); color: var(--accent-orange); }
        .priority-medium { background: rgba(55, 66, 250, 0.2); color: var(--accent-blue); }
        .priority-low { background: rgba(139, 139, 154, 0.2); color: var(--text-secondary); }
        .priority-on-target { background: rgba(0, 255, 136, 0.2); color: var(--accent-green); }

        .week-cell {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            text-align: center;
            min-width: 55px;
            padding: 6px 4px !important;
        }

        .week-cell.high { color: var(--accent-green); background: rgba(0, 255, 136, 0.1); }
        .week-cell.medium { color: var(--accent-orange); background: rgba(255, 165, 2, 0.1); }
        .week-cell.low { color: var(--accent-red); background: rgba(255, 71, 87, 0.1); }
        .week-cell.none { color: var(--text-muted); }

        .trend-arrow { display: inline-flex; align-items: center; gap: 4px; font-size: 0.85rem; font-family: 'JetBrains Mono', monospace; }
        .trend-arrow.up { color: var(--accent-green); }
        .trend-arrow.down { color: var(--accent-red); }
        .trend-arrow.flat { color: var(--text-muted); }

        .full-width { grid-column: 1 / -1; }

        .action-list { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }

        .action-card {
            background: var(--bg-card-hover);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
        }

        .action-card.critical { border-left: 3px solid var(--accent-red); }
        .action-card.high { border-left: 3px solid var(--accent-orange); }

        .action-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px; }
        .action-dsp { font-size: 1.5rem; font-weight: 700; font-family: 'JetBrains Mono', monospace; }

        .action-station {
            background: var(--bg-dark);
            padding: 4px 10px;
            border-radius: 8px;
            font-size: 0.8rem;
            font-family: 'JetBrains Mono', monospace;
            color: var(--text-secondary);
        }

        .action-stats { display: flex; gap: 16px; margin-bottom: 12px; }
        .action-stat { display: flex; flex-direction: column; }
        .action-stat-label { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; }
        .action-stat-value { font-size: 1.1rem; font-weight: 600; font-family: 'JetBrains Mono', monospace; }
        .action-stat-value.red { color: var(--accent-red); }
        .action-stat-value.orange { color: var(--accent-orange); }

        .action-location {
            font-size: 0.85rem;
            color: var(--text-secondary);
            padding-top: 12px;
            border-top: 1px solid var(--border-color);
        }

        .chart-container { position: relative; height: 300px; width: 100%; }
        .chart-container.tall { height: 400px; }

        .filter-row { display: flex; gap: 8px; margin-bottom: 16px; flex-wrap: wrap; }

        .filter-btn {
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            cursor: pointer;
            background: var(--bg-card-hover);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
        }

        .filter-btn:hover, .filter-btn.active {
            background: var(--accent-blue);
            border-color: var(--accent-blue);
            color: white;
        }

        .table-scroll { max-height: 400px; overflow-y: auto; }

        .wow-change { font-family: 'JetBrains Mono', monospace; font-size: 0.8rem; padding: 2px 6px; border-radius: 4px; }
        .wow-change.positive { color: var(--accent-green); background: rgba(0, 255, 136, 0.1); }
        .wow-change.negative { color: var(--accent-red); background: rgba(255, 71, 87, 0.1); }
        .wow-change.neutral { color: var(--text-muted); }

        @media (max-width: 1200px) {
            .kpi-row { grid-template-columns: repeat(3, 1fr); }
            .action-list { grid-template-columns: repeat(2, 1fr); }
        }
        @media (max-width: 900px) {
            .main-grid { grid-template-columns: 1fr; }
            .kpi-row { grid-template-columns: repeat(2, 1fr); }
            .action-list { grid-template-columns: 1fr; }
        }
        @media (max-width: 600px) {
            .header { flex-direction: column; gap: 16px; }
            .kpi-row { grid-template-columns: 1fr; }
            .nav-tabs { flex-wrap: wrap; }
        }

        .adoption-bar-container { display: flex; align-items: center; gap: 10px; }
        .adoption-bar { flex: 1; height: 8px; background: var(--border-color); border-radius: 4px; overflow: hidden; position: relative; }
        .adoption-bar::after { content: ''; position: absolute; left: 85%; top: 0; width: 2px; height: 100%; background: var(--text-muted); }
        .adoption-fill { height: 100%; border-radius: 4px; }
        .adoption-fill.on-target { background: linear-gradient(90deg, var(--accent-green), #00cc6a); }
        .adoption-fill.below-target { background: linear-gradient(90deg, var(--accent-red), var(--accent-orange)); }
        .adoption-value { font-family: 'JetBrains Mono', monospace; font-weight: 600; min-width: 50px; text-align: right; }
    </style>
</head>
<body>
    <div class="bg-grid"></div>
    
    <div class="container">
        <header class="header">
            <div class="header-left">
                <h1>Kooner Adoption Dashboard</h1>
                <div class="subtitle">
                    <span>Vendor Adoption Tracking</span>
                    <span class="target-badge">TARGET: 85%</span>
                </div>
            </div>
            <div class="header-right">
                <div class="last-updated">Last Updated: 2026-02-02</div>
                <div class="data-period">Data Period: WK51 (Dec 7) - WK5 (Jan 31)</div>
            </div>
        </header>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('overview')">üìä Overview</button>
            <button class="nav-tab" onclick="showTab('trends')">üìà Week-over-Week</button>
            <button class="nav-tab" onclick="showTab('stations')">üè¢ Stations</button>
            <button class="nav-tab" onclick="showTab('dsps')">üöõ DSPs</button>
            <button class="nav-tab" onclick="showTab('actions')">üéØ Actions</button>
        </div>

        <!-- OVERVIEW TAB -->
        <div id="overview" class="tab-content active">
            <div class="kpi-row">
                <div class="kpi-card">
                    <div class="kpi-label">Total Kooner WOs</div>
                    <div class="kpi-value">1,060</div>
                    <div class="kpi-subtext">Completed by Kooner</div>
                </div>
                <div class="kpi-card warning">
                    <div class="kpi-label">Total Leaked WOs</div>
                    <div class="kpi-value orange">580</div>
                    <div class="kpi-subtext">Sent to other vendors</div>
                </div>
                <div class="kpi-card danger">
                    <div class="kpi-label">Current Adoption</div>
                    <div class="kpi-value red">64.6%</div>
                    <div class="kpi-trend up">‚Üë +6.1% from WK4</div>
                </div>
                <div class="kpi-card danger">
                    <div class="kpi-label">Gap to Target</div>
                    <div class="kpi-value red">20.4%</div>
                    <div class="kpi-subtext">vs 85% target</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-label">DSPs Tracked</div>
                    <div class="kpi-value">26</div>
                    <div class="kpi-subtext">11 on target, 15 below</div>
                </div>
            </div>

            <div class="main-grid">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Overall Adoption Trend</div>
                        <span class="card-badge badge-trends">8 WEEKS</span>
                    </div>
                    <div class="chart-container">
                        <canvas id="overallTrendChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Weekly Performance</div>
                    </div>
                    <div class="chart-container">
                        <canvas id="weeklyBarChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Station Status</div>
                        <span class="card-badge badge-stations">9 STATIONS</span>
                    </div>
                    <div class="table-scroll" style="max-height: 300px;">
                        <table class="data-table">
                            <thead><tr><th>Station</th><th>Adoption</th><th>WoW</th><th>Status</th></tr></thead>
                            <tbody id="stationQuickTable"></tbody>
                        </table>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Top Priority DSPs</div>
                        <span class="card-badge badge-dsps">ACTION NEEDED</span>
                    </div>
                    <div class="table-scroll" style="max-height: 300px;">
                        <table class="data-table">
                            <thead><tr><th>DSP</th><th>Station</th><th>Adoption</th><th>Trend</th></tr></thead>
                            <tbody id="dspQuickTable"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- TRENDS TAB -->
        <div id="trends" class="tab-content">
            <div class="main-grid">
                <div class="card full-width">
                    <div class="card-header">
                        <div class="card-title">üìà Week-over-Week Adoption (Sunday - Saturday)</div>
                    </div>
                    <div class="chart-container tall">
                        <canvas id="wowOverallChart"></canvas>
                    </div>
                </div>

                <div class="card full-width">
                    <div class="card-header">
                        <div class="card-title">Weekly Performance Summary</div>
                    </div>
                    <table class="data-table">
                        <thead><tr><th>Week</th><th>Dates</th><th>Kooner</th><th>Leaked</th><th>Total</th><th>Adoption</th><th>WoW Change</th></tr></thead>
                        <tbody id="weeklyTable"></tbody>
                    </table>
                </div>

                <div class="card full-width">
                    <div class="card-header">
                        <div class="card-title">üè¢ Station Weekly Heatmap</div>
                    </div>
                    <div class="table-scroll">
                        <table class="data-table">
                            <thead><tr><th>Station</th><th>WK51</th><th>WK52</th><th>WK53</th><th>WK1</th><th>WK2</th><th>WK3</th><th>WK4</th><th>WK5</th><th>Trend</th></tr></thead>
                            <tbody id="stationHeatmap"></tbody>
                        </table>
                    </div>
                </div>

                <div class="card full-width">
                    <div class="card-header">
                        <div class="card-title">üè¢ Station Trends</div>
                    </div>
                    <div class="chart-container tall">
                        <canvas id="stationTrendChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- STATIONS TAB -->
        <div id="stations" class="tab-content">
            <div class="main-grid">
                <div class="card full-width">
                    <div class="card-header">
                        <div class="card-title">Station Adoption Details</div>
                        <span class="card-badge badge-stations">9 STATIONS</span>
                    </div>
                    <table class="data-table">
                        <thead><tr><th>Station</th><th>Location</th><th>Adoption Rate</th><th>Kooner</th><th>Leaked</th><th>Gap to 85%</th><th>WK4‚ÜíWK5</th><th>Status</th></tr></thead>
                        <tbody id="stationFullTable"></tbody>
                    </table>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Station Adoption Comparison</div>
                    </div>
                    <div class="chart-container">
                        <canvas id="stationBarChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Leakage by Station</div>
                    </div>
                    <div class="chart-container">
                        <canvas id="stationLeakageChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- DSPS TAB -->
        <div id="dsps" class="tab-content">
            <div class="main-grid">
                <div class="card full-width">
                    <div class="card-header">
                        <div class="card-title">DSP Adoption Tracking</div>
                        <span class="card-badge badge-dsps">26 DSPs</span>
                    </div>
                    <div class="filter-row">
                        <button class="filter-btn active" onclick="filterDSPs('all')">All</button>
                        <button class="filter-btn" onclick="filterDSPs('critical')">Critical</button>
                        <button class="filter-btn" onclick="filterDSPs('high')">High</button>
                        <button class="filter-btn" onclick="filterDSPs('medium')">Medium</button>
                        <button class="filter-btn" onclick="filterDSPs('low')">Low</button>
                        <button class="filter-btn" onclick="filterDSPs('on-target')">On Target</button>
                    </div>
                    <div class="table-scroll" style="max-height: 500px;">
                        <table class="data-table">
                            <thead><tr><th>DSP</th><th>Station</th><th>Location</th><th>Adoption</th><th>Kooner</th><th>Leaked</th><th>Gap</th><th>WK5</th><th>Priority</th></tr></thead>
                            <tbody id="dspFullTable"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- ACTIONS TAB -->
        <div id="actions" class="tab-content">
            <div class="main-grid">
                <div class="card full-width">
                    <div class="card-header">
                        <div class="card-title">üéØ Priority Action List - Where to Go</div>
                    </div>
                    <div class="action-list" id="actionList"></div>
                </div>

                <div class="card full-width">
                    <div class="card-header">
                        <div class="card-title">üìã DSP ‚Üí Station Quick Reference</div>
                    </div>
                    <table class="data-table">
                        <thead><tr><th>Priority</th><th>DSP</th><th>Station</th><th>Location</th><th>Adoption</th><th>Leaked WOs</th><th>Action</th></tr></thead>
                        <tbody id="actionTable"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // DATA
        const weekLabels = ['WK51', 'WK52', 'WK53', 'WK1', 'WK2', 'WK3', 'WK4', 'WK5'];
        const weekDates = {
            'WK51': 'Dec 7-13', 'WK52': 'Dec 14-20', 'WK53': 'Dec 21-27', 'WK1': 'Dec 28-Jan 3',
            'WK2': 'Jan 4-10', 'WK3': 'Jan 11-17', 'WK4': 'Jan 18-24', 'WK5': 'Jan 25-31'
        };
        
        const overallWeekly = [
            { week: 'WK51', kooner: 142, leaked: 75, total: 217, adoption: 65.4 },
            { week: 'WK52', kooner: 120, leaked: 51, total: 171, adoption: 70.2 },
            { week: 'WK53', kooner: 70, leaked: 66, total: 136, adoption: 51.5 },
            { week: 'WK1', kooner: 135, leaked: 19, total: 154, adoption: 87.7 },
            { week: 'WK2', kooner: 141, leaked: 103, total: 244, adoption: 57.8 },
            { week: 'WK3', kooner: 140, leaked: 78, total: 218, adoption: 64.2 },
            { week: 'WK4', kooner: 159, leaked: 108, total: 267, adoption: 59.6 },
            { week: 'WK5', kooner: 153, leaked: 80, total: 233, adoption: 65.7 }
        ];

        const stationWeekly = {
            'HTP2': { data: [86.1, 92.3, 92.9, 100, 90.9, 88.9, 76.2, 77.8], kooner: 140, leaked: 17, location: 'Gibsonton, FL' },
            'HHO3': { data: [71.4, 90.0, 83.3, 93.8, 95.7, 100, 79.2, 78.9], kooner: 148, leaked: 22, location: 'Porter, TX' },
            'HMS2': { data: [83.3, 100, 0, 100, 37.5, 55.6, 73.3, 69.2], kooner: 54, leaked: 27, location: 'Lakeville, MN' },
            'HIN3': { data: [42.9, 33.3, 54.5, 100, 100, 50, 100, 33.3], kooner: 26, leaked: 15, location: '' },
            'HDT3': { data: [53.3, 55.2, 31.6, 75.0, 36.6, 56.7, 55.3, 80.0], kooner: 180, leaked: 120, location: 'Romulus, MI' },
            'HCL2': { data: [0, 0, 0, 66.7, 38.5, 76.3, 53.3, 71.4], kooner: 54, leaked: 51, location: '' },
            'HLA2': { data: [57.8, 54.1, 37.5, 81.2, 27.0, 36.5, 49.4, 61.2], kooner: 220, leaked: 225, location: 'Santa Clarita, CA' },
            'HAU1': { data: [71.4, 25.0, 21.7, 88.9, 92.3, 83.3, 48.3, 12.5], kooner: 67, leaked: 71, location: 'Austin, TX' },
            'HPD1': { data: [0, 0, 0, 0, 0, 0, 0, 14.3], kooner: 3, leaked: 32, location: 'Portland, OR' }
        };

        const dspData = [
            { dsp: 'ARMA', station: 'HLA2', location: 'Santa Clarita, CA', kooner: 3, leaked: 101, adoption: 2.9, gap: 82.1, priority: 'critical', weekly: [10, 14.3, 0, 0, 0, 0, 0, 0] },
            { dsp: 'JDTC', station: 'HPD1', location: 'Portland, OR', kooner: 2, leaked: 32, adoption: 5.9, gap: 79.1, priority: 'high', weekly: [0, 0, 0, 0, 0, 0, 0, 14.3] },
            { dsp: 'SFRM', station: 'HDT3', location: 'Romulus, MI', kooner: 68, leaked: 113, adoption: 37.6, gap: 47.4, priority: 'critical', weekly: [31.6, 7.7, 0, 50, 24.2, 36.8, 33.3, 63] },
            { dsp: 'GMIL', station: 'HAU1', location: 'Austin, TX', kooner: 8, leaked: 11, adoption: 42.1, gap: 42.9, priority: 'low', weekly: [33.3, null, 0, 100, 80, 0, 50, 0] },
            { dsp: 'FICL', station: 'HAU1', location: 'Austin, TX', kooner: 53, leaked: 60, adoption: 46.9, gap: 38.1, priority: 'critical', weekly: [75, 25, 25, 87.5, 100, 90.9, 45.8, 5] },
            { dsp: 'ARVL', station: 'HTP2', location: 'Gibsonton, FL', kooner: 6, leaked: 5, adoption: 54.5, gap: 30.5, priority: 'low', weekly: [50, 50, 0, 100, 0, 50, null, 100] },
            { dsp: 'BORN', station: 'HLA2', location: 'Santa Clarita, CA', kooner: 62, leaked: 47, adoption: 56.9, gap: 28.1, priority: 'high', weekly: [81.8, 100, 75, 100, 87.5, 34.8, 46.7, 52] },
            { dsp: 'LDOG', station: 'HMS2', location: 'Lakeville, MN', kooner: 45, leaked: 27, adoption: 62.5, gap: 22.5, priority: 'high', weekly: [80, 100, 0, 100, 37.5, 55.6, 71.4, 60] },
            { dsp: 'MDAS', station: 'HLA2', location: 'Santa Clarita, CA', kooner: 120, leaked: 73, adoption: 62.2, gap: 22.8, priority: 'high', weekly: [60, 42.1, 0, 80, 37.9, 61.1, 64.9, 92] },
            { dsp: 'NLZL', station: 'HHO3', location: 'Porter, TX', kooner: 17, leaked: 7, adoption: 70.8, gap: 14.2, priority: 'medium', weekly: [null, null, null, null, null, null, null, null] },
            { dsp: 'RRTL', station: 'HHO3', location: 'Porter, TX', kooner: 41, leaked: 13, adoption: 75.9, gap: 9.1, priority: 'high', weekly: [42.9, 0, 0, 85.7, 80, 100, 66.7, 71.4] },
            { dsp: 'DASL', station: 'HHO3', location: 'Porter, TX', kooner: 10, leaked: 2, adoption: 83.3, gap: 1.7, priority: 'low', weekly: [null, 100, null, 100, 100, 100, 33.3, 100] },
            { dsp: 'DGWD', station: 'HCL2', location: '', kooner: 0, leaked: 28, adoption: 0, gap: 85, priority: 'high', weekly: [0, 0, 0, 0, 0, 0, 0, 0] },
            { dsp: 'D4DS', station: 'HCL2', location: '', kooner: 0, leaked: 23, adoption: 0, gap: 85, priority: 'high', weekly: [0, 0, null, null, 0, 0, 0, 0] },
            { dsp: 'ORMP', station: 'HTP2', location: 'Gibsonton, FL', kooner: 121, leaked: 12, adoption: 91, gap: -6, priority: 'on-target', weekly: [71.4, 100, null, 100, 94.4, 100, 73.7, 66.7] },
            { dsp: 'ALAB', station: 'HDT3', location: 'Romulus, MI', kooner: 68, leaked: 7, adoption: 90.7, gap: -5.7, priority: 'on-target', weekly: [80, 88.9, 100, 93.3, 83.3, 90, 90, 92.9] },
            { dsp: 'CMIL', station: 'HIN3', location: '', kooner: 23, leaked: 2, adoption: 92, gap: -7, priority: 'on-target', weekly: [75, null, 100, 100, 100, 66.7, 100, 100] },
            { dsp: 'PERP', station: 'HMK4', location: '', kooner: 44, leaked: 0, adoption: 100, gap: -15, priority: 'on-target', weekly: [100, 100, 100, 100, null, 100, 100, 100] },
            { dsp: 'PRLC', station: 'HSL1', location: '', kooner: 41, leaked: 0, adoption: 100, gap: -15, priority: 'on-target', weekly: [100, 100, null, 100, 100, 100, 100, 100] }
        ];

        // Functions
        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(b => b.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            event.target.classList.add('active');
        }

        function filterDSPs(filter) {
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            populateDSPFullTable(filter);
        }

        function getWoWChange(data, idx) {
            if (idx === 0 || data[idx] == null || data[idx-1] == null) return null;
            return data[idx] - data[idx-1];
        }

        function getTrendArrow(change) {
            if (change == null) return '<span class="trend-arrow flat">‚Äî</span>';
            if (change > 5) return '<span class="trend-arrow up">‚Üë +' + change.toFixed(1) + '%</span>';
            if (change < -5) return '<span class="trend-arrow down">‚Üì ' + change.toFixed(1) + '%</span>';
            return '<span class="trend-arrow flat">‚Üí ' + (change >= 0 ? '+' : '') + change.toFixed(1) + '%</span>';
        }

        function getCellClass(v) {
            if (v == null) return 'none';
            if (v >= 85) return 'high';
            if (v >= 50) return 'medium';
            return 'low';
        }

        function populateWeeklyTable() {
            var tbody = document.getElementById('weeklyTable');
            var prev = null;
            var html = '';
            overallWeekly.forEach(function(r) {
                var change = prev != null ? r.adoption - prev : null;
                var changeHtml = change != null 
                    ? '<span class="wow-change ' + (change >= 0 ? 'positive' : 'negative') + '">' + (change >= 0 ? '+' : '') + change.toFixed(1) + '%</span>'
                    : '<span class="wow-change neutral">‚Äî</span>';
                prev = r.adoption;
                html += '<tr><td><span class="station-name">' + r.week + '</span></td><td>' + weekDates[r.week] + '</td><td>' + r.kooner + '</td><td>' + r.leaked + '</td><td>' + r.total + '</td><td style="color: ' + (r.adoption >= 85 ? 'var(--accent-green)' : 'var(--accent-red)') + '">' + r.adoption.toFixed(1) + '%</td><td>' + changeHtml + '</td></tr>';
            });
            tbody.innerHTML = html;
        }

        function populateStationHeatmap() {
            var tbody = document.getElementById('stationHeatmap');
            var sorted = Object.entries(stationWeekly).sort(function(a,b) {
                var aAdopt = a[1].kooner / (a[1].kooner + a[1].leaked);
                var bAdopt = b[1].kooner / (b[1].kooner + b[1].leaked);
                return bAdopt - aAdopt;
            });
            var html = '';
            sorted.forEach(function(item) {
                var st = item[0];
                var info = item[1];
                var change = getWoWChange(info.data, 7);
                html += '<tr><td><span class="station-name">' + st + '</span></td>';
                info.data.forEach(function(v) {
                    html += '<td class="week-cell ' + getCellClass(v) + '">' + (v != null ? v.toFixed(0) + '%' : '‚Äî') + '</td>';
                });
                html += '<td>' + getTrendArrow(change) + '</td></tr>';
            });
            tbody.innerHTML = html;
        }

        function populateStationQuickTable() {
            var tbody = document.getElementById('stationQuickTable');
            var sorted = Object.entries(stationWeekly).sort(function(a,b) {
                var aAdopt = a[1].kooner / (a[1].kooner + a[1].leaked);
                var bAdopt = b[1].kooner / (b[1].kooner + b[1].leaked);
                return bAdopt - aAdopt;
            });
            var html = '';
            sorted.forEach(function(item) {
                var st = item[0];
                var info = item[1];
                var adoption = (info.kooner / (info.kooner + info.leaked) * 100);
                var change = getWoWChange(info.data, 7);
                var onTarget = adoption >= 85;
                html += '<tr><td><span class="station-name">' + st + '</span></td><td style="color: ' + (onTarget ? 'var(--accent-green)' : 'var(--accent-red)') + '">' + adoption.toFixed(1) + '%</td><td>' + getTrendArrow(change) + '</td><td><span class="status-pill ' + (onTarget ? 'on-target' : 'below-target') + '"><span class="status-dot"></span>' + (onTarget ? 'On Target' : 'Below') + '</span></td></tr>';
            });
            tbody.innerHTML = html;
        }

        function populateStationFullTable() {
            var tbody = document.getElementById('stationFullTable');
            var sorted = Object.entries(stationWeekly).sort(function(a,b) {
                var aAdopt = a[1].kooner / (a[1].kooner + a[1].leaked);
                var bAdopt = b[1].kooner / (b[1].kooner + b[1].leaked);
                return bAdopt - aAdopt;
            });
            var html = '';
            sorted.forEach(function(item) {
                var st = item[0];
                var info = item[1];
                var adoption = info.kooner / (info.kooner + info.leaked) * 100;
                var gap = 85 - adoption;
                var change = getWoWChange(info.data, 7);
                var onTarget = adoption >= 85;
                html += '<tr><td><span class="station-name">' + st + '</span></td><td>' + (info.location || '‚Äî') + '</td><td><div class="adoption-bar-container"><div class="adoption-bar"><div class="adoption-fill ' + (onTarget ? 'on-target' : 'below-target') + '" style="width:' + adoption + '%"></div></div><span class="adoption-value" style="color:' + (onTarget ? 'var(--accent-green)' : 'var(--accent-red)') + '">' + adoption.toFixed(1) + '%</span></div></td><td>' + info.kooner + '</td><td>' + info.leaked + '</td><td style="color:' + (gap > 0 ? 'var(--accent-red)' : 'var(--accent-green)') + '">' + (gap > 0 ? '+' : '') + gap.toFixed(1) + '%</td><td>' + getTrendArrow(change) + '</td><td><span class="status-pill ' + (onTarget ? 'on-target' : 'below-target') + '"><span class="status-dot"></span>' + (onTarget ? 'On Target' : 'Below') + '</span></td></tr>';
            });
            tbody.innerHTML = html;
        }

        function populateDSPQuickTable() {
            var tbody = document.getElementById('dspQuickTable');
            var priority = dspData.filter(function(d) { return d.priority === 'critical' || d.priority === 'high'; }).sort(function(a,b) { return a.adoption - b.adoption; }).slice(0, 8);
            var html = '';
            priority.forEach(function(d) {
                var change = d.weekly[7] != null && d.weekly[6] != null ? d.weekly[7] - d.weekly[6] : null;
                html += '<tr><td><span class="station-name">' + d.dsp + '</span></td><td><span class="action-station">' + d.station + '</span></td><td style="color: var(--accent-red)">' + d.adoption.toFixed(1) + '%</td><td>' + getTrendArrow(change) + '</td></tr>';
            });
            tbody.innerHTML = html;
        }

        function populateDSPFullTable(filter) {
            filter = filter || 'all';
            var tbody = document.getElementById('dspFullTable');
            var filtered = filter === 'all' ? dspData : dspData.filter(function(d) { return d.priority === filter; });
            filtered = filtered.slice().sort(function(a,b) { return a.adoption - b.adoption; });
            var html = '';
            filtered.forEach(function(d) {
                var onTarget = d.adoption >= 85;
                var wk5 = d.weekly[7];
                html += '<tr><td><span class="station-name">' + d.dsp + '</span></td><td><span class="action-station">' + d.station + '</span></td><td>' + (d.location || '‚Äî') + '</td><td><div class="adoption-bar-container"><div class="adoption-bar" style="width:80px"><div class="adoption-fill ' + (onTarget ? 'on-target' : 'below-target') + '" style="width:' + d.adoption + '%"></div></div><span class="adoption-value" style="color:' + (onTarget ? 'var(--accent-green)' : 'var(--accent-red)') + '">' + d.adoption.toFixed(1) + '%</span></div></td><td>' + d.kooner + '</td><td>' + d.leaked + '</td><td style="color:' + (d.gap > 0 ? 'var(--accent-red)' : 'var(--accent-green)') + '">' + (d.gap > 0 ? '+' : '') + d.gap.toFixed(1) + '%</td><td class="week-cell ' + getCellClass(wk5) + '">' + (wk5 != null ? wk5.toFixed(0) + '%' : '‚Äî') + '</td><td><span class="priority-pill priority-' + d.priority + '">' + d.priority + '</span></td></tr>';
            });
            tbody.innerHTML = html;
        }

        function populateActionCards() {
            var container = document.getElementById('actionList');
            var priority = dspData.filter(function(d) { return d.priority === 'critical' || d.priority === 'high'; }).sort(function(a,b) { return b.leaked - a.leaked; }).slice(0, 6);
            var html = '';
            priority.forEach(function(d) {
                html += '<div class="action-card ' + d.priority + '"><div class="action-header"><span class="action-dsp">' + d.dsp + '</span><span class="action-station">üìç ' + d.station + '</span></div><div class="action-stats"><div class="action-stat"><span class="action-stat-label">Adoption</span><span class="action-stat-value red">' + d.adoption.toFixed(1) + '%</span></div><div class="action-stat"><span class="action-stat-label">Leaked WOs</span><span class="action-stat-value orange">' + d.leaked + '</span></div><div class="action-stat"><span class="action-stat-label">Priority</span><span class="priority-pill priority-' + d.priority + '">' + d.priority + '</span></div></div>' + (d.location ? '<div class="action-location">üìå ' + d.location + '</div>' : '') + '</div>';
            });
            container.innerHTML = html;
        }

        function populateActionTable() {
            var tbody = document.getElementById('actionTable');
            var actions = dspData.filter(function(d) { return d.priority !== 'on-target'; }).sort(function(a,b) {
                var order = { critical: 0, high: 1, medium: 2, low: 3 };
                return order[a.priority] - order[b.priority] || b.leaked - a.leaked;
            });
            var html = '';
            actions.forEach(function(d) {
                var action = d.priority === 'critical' ? 'Schedule fleet manager meeting' : d.priority === 'high' ? 'Outreach & propose agreement' : 'Monitor relationship';
                html += '<tr><td><span class="priority-pill priority-' + d.priority + '">' + d.priority + '</span></td><td><span class="station-name">' + d.dsp + '</span></td><td><span class="action-station">' + d.station + '</span></td><td>' + (d.location || '‚Äî') + '</td><td style="color: var(--accent-red)">' + d.adoption.toFixed(1) + '%</td><td>' + d.leaked + '</td><td>' + action + '</td></tr>';
            });
            tbody.innerHTML = html;
        }

        function createCharts() {
            var colors = ['#ff4757', '#ffa502', '#3742fa', '#a855f7', '#00ff88', '#00d4ff', '#ff6b81', '#2ed573', '#1e90ff'];

            // Overall Trend
            new Chart(document.getElementById('overallTrendChart'), {
                type: 'line',
                data: {
                    labels: weekLabels,
                    datasets: [{
                        label: 'Adoption Rate',
                        data: overallWeekly.map(function(d) { return d.adoption; }),
                        borderColor: '#3742fa',
                        backgroundColor: 'rgba(55, 66, 250, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: overallWeekly.map(function(d) { return d.adoption >= 85 ? '#00ff88' : '#ff4757'; }),
                        pointRadius: 6
                    }, {
                        label: 'Target (85%)',
                        data: [85, 85, 85, 85, 85, 85, 85, 85],
                        borderColor: '#00ff88',
                        borderDash: [5, 5],
                        pointRadius: 0,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { labels: { color: '#8b8b9a' } } },
                    scales: {
                        y: { beginAtZero: true, max: 100, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#8b8b9a', callback: function(v) { return v + '%'; } } },
                        x: { grid: { display: false }, ticks: { color: '#8b8b9a' } }
                    }
                }
            });

            // Weekly Bar
            new Chart(document.getElementById('weeklyBarChart'), {
                type: 'bar',
                data: {
                    labels: weekLabels,
                    datasets: [
                        { label: 'Kooner WOs', data: overallWeekly.map(function(d) { return d.kooner; }), backgroundColor: 'rgba(0, 255, 136, 0.7)', borderRadius: 4 },
                        { label: 'Leaked WOs', data: overallWeekly.map(function(d) { return d.leaked; }), backgroundColor: 'rgba(255, 71, 87, 0.7)', borderRadius: 4 }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { labels: { color: '#8b8b9a' } } },
                    scales: {
                        y: { stacked: true, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#8b8b9a' } },
                        x: { stacked: true, grid: { display: false }, ticks: { color: '#8b8b9a' } }
                    }
                }
            });

            // WoW Overall
            new Chart(document.getElementById('wowOverallChart'), {
                type: 'line',
                data: {
                    labels: weekLabels.map(function(w) { return w + '\n' + weekDates[w]; }),
                    datasets: [{
                        label: 'Adoption Rate',
                        data: overallWeekly.map(function(d) { return d.adoption; }),
                        borderColor: '#3742fa',
                        backgroundColor: 'rgba(55, 66, 250, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: overallWeekly.map(function(d) { return d.adoption >= 85 ? '#00ff88' : '#ff4757'; }),
                        pointRadius: 8
                    }, {
                        label: 'Target (85%)',
                        data: [85, 85, 85, 85, 85, 85, 85, 85],
                        borderColor: '#00ff88',
                        borderDash: [5, 5],
                        pointRadius: 0,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { labels: { color: '#8b8b9a' } } },
                    scales: {
                        y: { beginAtZero: true, max: 100, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#8b8b9a', callback: function(v) { return v + '%'; } } },
                        x: { grid: { display: false }, ticks: { color: '#8b8b9a' } }
                    }
                }
            });

            // Station Trend
            var stationDatasets = [];
            var i = 0;
            for (var st in stationWeekly) {
                stationDatasets.push({
                    label: st,
                    data: stationWeekly[st].data,
                    borderColor: colors[i % colors.length],
                    backgroundColor: 'transparent',
                    tension: 0.3,
                    pointRadius: 3
                });
                i++;
            }
            new Chart(document.getElementById('stationTrendChart'), {
                type: 'line',
                data: { labels: weekLabels, datasets: stationDatasets },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { labels: { color: '#8b8b9a' }, position: 'right' } },
                    scales: {
                        y: { beginAtZero: true, max: 100, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#8b8b9a', callback: function(v) { return v + '%'; } } },
                        x: { grid: { display: false }, ticks: { color: '#8b8b9a' } }
                    }
                }
            });

            // Station Bar
            var sortedStations = Object.entries(stationWeekly).map(function(e) { return { st: e[0], adoption: e[1].kooner / (e[1].kooner + e[1].leaked) * 100 }; }).sort(function(a,b) { return b.adoption - a.adoption; });
            new Chart(document.getElementById('stationBarChart'), {
                type: 'bar',
                data: {
                    labels: sortedStations.map(function(s) { return s.st; }),
                    datasets: [{ data: sortedStations.map(function(s) { return s.adoption; }), backgroundColor: sortedStations.map(function(s) { return s.adoption >= 85 ? 'rgba(0, 255, 136, 0.7)' : 'rgba(255, 71, 87, 0.7)'; }), borderRadius: 4 }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { beginAtZero: true, max: 100, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#8b8b9a', callback: function(v) { return v + '%'; } } },
                        y: { grid: { display: false }, ticks: { color: '#8b8b9a' } }
                    }
                }
            });

            // Leakage Pie
            var leakageSorted = Object.entries(stationWeekly).map(function(e) { return { st: e[0], leaked: e[1].leaked }; }).sort(function(a,b) { return b.leaked - a.leaked; });
            new Chart(document.getElementById('stationLeakageChart'), {
                type: 'doughnut',
                data: {
                    labels: leakageSorted.map(function(s) { return s.st; }),
                    datasets: [{ data: leakageSorted.map(function(s) { return s.leaked; }), backgroundColor: colors, borderWidth: 0 }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'right', labels: { color: '#8b8b9a', padding: 12 } } },
                    cutout: '60%'
                }
            });
        }

        // Initialize
        window.onload = function() {
            populateWeeklyTable();
            populateStationHeatmap();
            populateStationQuickTable();
            populateStationFullTable();
            populateDSPQuickTable();
            populateDSPFullTable('all');
            populateActionCards();
            populateActionTable();
            createCharts();
        };
    </script>
</body>
</html>
