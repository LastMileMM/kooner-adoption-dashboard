<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kooner Adoption Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
    <style>
        :root{--bg-dark:#0a0a0f;--bg-card:#12121a;--bg-card-hover:#1a1a25;--accent-green:#00ff88;--accent-red:#ff4757;--accent-orange:#ffa502;--accent-blue:#3742fa;--accent-purple:#a855f7;--accent-cyan:#00d4ff;--accent-yellow:#ffd93d;--text-primary:#ffffff;--text-secondary:#8b8b9a;--text-muted:#4a4a5a;--border-color:#2a2a3a}
        *{margin:0;padding:0;box-sizing:border-box}body{font-family:'Space Grotesk',sans-serif;background:var(--bg-dark);color:var(--text-primary);min-height:100vh}
        .bg-grid{position:fixed;top:0;left:0;width:100%;height:100%;background-image:linear-gradient(rgba(55,66,250,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(55,66,250,0.03) 1px,transparent 1px);background-size:50px 50px;pointer-events:none;z-index:0}
        .container{position:relative;z-index:1;max-width:1600px;margin:0 auto;padding:24px}
        .header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:32px;padding-bottom:24px;border-bottom:1px solid var(--border-color)}
        .header-left h1{font-size:2.5rem;font-weight:700;letter-spacing:-0.02em;margin-bottom:8px;background:linear-gradient(135deg,#fff 0%,#8b8b9a 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
        .header-left .subtitle{color:var(--text-secondary);font-size:1rem;display:flex;align-items:center;gap:12px}
        .target-badge{background:linear-gradient(135deg,var(--accent-green),#00cc6a);color:#000;padding:4px 12px;border-radius:20px;font-weight:600;font-size:0.85rem}
        .header-right{text-align:right}.last-updated{color:var(--text-muted);font-size:0.85rem;font-family:'JetBrains Mono',monospace}.data-period{color:var(--text-secondary);font-size:0.9rem;margin-top:4px}
        .nav-tabs{display:flex;gap:8px;margin-bottom:24px;background:var(--bg-card);padding:8px;border-radius:12px;width:fit-content;flex-wrap:wrap}
        .nav-tab{padding:10px 20px;border-radius:8px;font-size:0.9rem;font-weight:500;cursor:pointer;transition:all 0.2s ease;background:transparent;border:none;color:var(--text-secondary)}
        .nav-tab:hover{background:var(--bg-card-hover);color:var(--text-primary)}.nav-tab.active{background:var(--accent-blue);color:white}
        .tab-content{display:none}.tab-content.active{display:block}
        .kpi-row{display:grid;grid-template-columns:repeat(5,1fr);gap:16px;margin-bottom:32px}
        .kpi-card{background:var(--bg-card);border:1px solid var(--border-color);border-radius:16px;padding:24px;position:relative;overflow:hidden}
        .kpi-card::before{content:'';position:absolute;top:0;left:0;width:100%;height:3px;background:linear-gradient(90deg,var(--accent-blue),var(--accent-purple))}
        .kpi-card.success::before{background:linear-gradient(90deg,var(--accent-green),#00cc6a)}
        .kpi-card.warning::before{background:linear-gradient(90deg,var(--accent-orange),#ff6b00)}
        .kpi-card.danger::before{background:linear-gradient(90deg,var(--accent-red),#ff2f43)}
        .kpi-label{font-size:0.85rem;color:var(--text-secondary);text-transform:uppercase;letter-spacing:0.05em;margin-bottom:8px}
        .kpi-value{font-size:2.2rem;font-weight:700;font-family:'JetBrains Mono',monospace;line-height:1}
        .kpi-value.green{color:var(--accent-green)}.kpi-value.red{color:var(--accent-red)}.kpi-value.orange{color:var(--accent-orange)}.kpi-value.yellow{color:var(--accent-yellow)}
        .kpi-subtext{font-size:0.8rem;color:var(--text-muted);margin-top:8px}
        .main-grid{display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:32px}
        .card{background:var(--bg-card);border:1px solid var(--border-color);border-radius:16px;padding:24px}
        .card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
        .card-title{font-size:1.1rem;font-weight:600}
        .card-badge{font-size:0.75rem;padding:4px 10px;border-radius:12px;font-family:'JetBrains Mono',monospace}
        .badge-stations{background:rgba(55,66,250,0.2);color:var(--accent-blue)}
        .badge-dsps{background:rgba(168,85,247,0.2);color:var(--accent-purple)}
        .badge-trends{background:rgba(0,212,255,0.2);color:var(--accent-cyan)}
        .badge-insights{background:rgba(0,255,136,0.2);color:var(--accent-green)}
        .badge-sentiment{background:rgba(255,217,61,0.2);color:var(--accent-yellow)}
        .badge-calendar{background:rgba(255,71,87,0.2);color:var(--accent-red)}
        .data-table{width:100%;border-collapse:collapse}
        .data-table th{text-align:left;padding:12px 8px;font-size:0.75rem;text-transform:uppercase;letter-spacing:0.05em;color:var(--text-muted);border-bottom:1px solid var(--border-color);background:var(--bg-card)}
        .data-table td{padding:14px 8px;font-size:0.9rem;border-bottom:1px solid var(--border-color)}
        .data-table tr:hover td{background:rgba(55,66,250,0.05)}
        .station-name{font-weight:600;font-family:'JetBrains Mono',monospace}
        .status-pill{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;border-radius:20px;font-size:0.75rem;font-weight:500}
        .status-pill.on-target{background:rgba(0,255,136,0.15);color:var(--accent-green)}
        .status-pill.below-target{background:rgba(255,71,87,0.15);color:var(--accent-red)}
        .status-dot{width:6px;height:6px;border-radius:50%;background:currentColor}
        .priority-pill{display:inline-block;padding:4px 10px;border-radius:12px;font-size:0.7rem;font-weight:600;text-transform:uppercase}
        .priority-critical{background:rgba(255,71,87,0.2);color:var(--accent-red)}
        .priority-high{background:rgba(255,165,2,0.2);color:var(--accent-orange)}
        .priority-medium{background:rgba(55,66,250,0.2);color:var(--accent-blue)}
        .priority-low{background:rgba(139,139,154,0.2);color:var(--text-secondary)}
        .priority-on-target{background:rgba(0,255,136,0.2);color:var(--accent-green)}
        .full-width{grid-column:1/-1}
        .action-list{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
        .action-card{background:var(--bg-card-hover);border:1px solid var(--border-color);border-radius:12px;padding:20px}
        .action-card.critical{border-left:3px solid var(--accent-red)}.action-card.high{border-left:3px solid var(--accent-orange)}.action-card.medium{border-left:3px solid var(--accent-blue)}
        .action-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px}
        .action-dsp{font-size:1.3rem;font-weight:700;font-family:'JetBrains Mono',monospace}
        .action-station{background:var(--bg-dark);padding:4px 10px;border-radius:8px;font-size:0.8rem;font-family:'JetBrains Mono',monospace;color:var(--text-secondary)}
        .action-stats{display:flex;gap:16px;margin-bottom:12px;flex-wrap:wrap}
        .action-stat{display:flex;flex-direction:column}
        .action-stat-label{font-size:0.7rem;color:var(--text-muted);text-transform:uppercase}
        .action-stat-value{font-size:1rem;font-weight:600;font-family:'JetBrains Mono',monospace}
        .action-stat-value.red{color:var(--accent-red)}.action-stat-value.orange{color:var(--accent-orange)}.action-stat-value.green{color:var(--accent-green)}.action-stat-value.yellow{color:var(--accent-yellow)}
        .action-feedback{font-size:0.8rem;color:var(--text-secondary);padding:10px;background:var(--bg-dark);border-radius:8px;margin-top:10px;font-style:italic;border-left:2px solid var(--accent-yellow)}
        .chart-container{position:relative;height:300px;width:100%}.chart-container.tall{height:400px}
        .filter-row{display:flex;gap:8px;margin-bottom:16px;flex-wrap:wrap}
        .filter-btn{padding:6px 14px;border-radius:20px;font-size:0.8rem;font-weight:500;cursor:pointer;background:var(--bg-card-hover);border:1px solid var(--border-color);color:var(--text-secondary)}
        .filter-btn:hover,.filter-btn.active{background:var(--accent-blue);border-color:var(--accent-blue);color:white}
        .table-scroll{max-height:400px;overflow-y:auto}
        .insights-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px}
        .insight-card{background:var(--bg-card-hover);border:1px solid var(--border-color);border-radius:12px;padding:20px;border-left:4px solid var(--accent-blue)}
        .insight-card.positive{border-left-color:var(--accent-green)}.insight-card.negative{border-left-color:var(--accent-red)}
        .insight-card.warning{border-left-color:var(--accent-orange)}.insight-card.info{border-left-color:var(--accent-cyan)}
        .insight-icon{font-size:1.5rem;margin-bottom:10px}.insight-title{font-size:1rem;font-weight:600;margin-bottom:8px}
        .insight-text{font-size:0.9rem;color:var(--text-secondary);line-height:1.5}
        .insight-metric{display:inline-block;font-family:'JetBrains Mono',monospace;font-weight:600;padding:2px 6px;border-radius:4px;background:rgba(255,255,255,0.1)}
        .executive-summary{background:linear-gradient(135deg,rgba(55,66,250,0.1),rgba(168,85,247,0.1));border:1px solid var(--accent-blue);border-radius:12px;padding:24px;margin-bottom:24px}
        .executive-summary h3{font-size:1.2rem;margin-bottom:16px;color:var(--accent-cyan)}
        .executive-summary ul{list-style:none;padding:0}
        .executive-summary li{padding:8px 0;padding-left:24px;position:relative;color:var(--text-secondary);font-size:0.95rem;line-height:1.5}
        .executive-summary li::before{content:'‚Üí';position:absolute;left:0;color:var(--accent-blue)}
        .next-steps{background:var(--bg-card-hover);border:1px solid var(--border-color);border-radius:12px;padding:20px}
        .next-steps h4{font-size:1rem;margin-bottom:12px;color:var(--accent-orange)}
        .next-steps ol{padding-left:20px;color:var(--text-secondary)}.next-steps li{padding:6px 0;font-size:0.9rem}
        .sentiment-score{display:inline-flex;align-items:center;justify-content:center;width:32px;height:32px;border-radius:8px;font-family:'JetBrains Mono',monospace;font-weight:700;font-size:0.9rem}
        .sentiment-score.score-5{background:rgba(0,255,136,0.2);color:var(--accent-green)}
        .sentiment-score.score-4{background:rgba(0,212,255,0.2);color:var(--accent-cyan)}
        .sentiment-score.score-3{background:rgba(255,217,61,0.2);color:var(--accent-yellow)}
        .sentiment-score.score-2{background:rgba(255,165,2,0.2);color:var(--accent-orange)}
        .sentiment-score.score-1{background:rgba(255,71,87,0.2);color:var(--accent-red)}
        .feedback-card{background:var(--bg-card-hover);border:1px solid var(--border-color);border-radius:12px;padding:20px;margin-bottom:16px}
        .feedback-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px;padding-bottom:12px;border-bottom:1px solid var(--border-color);flex-wrap:wrap;gap:10px}
        .feedback-meta{display:flex;gap:16px;align-items:center;flex-wrap:wrap}.feedback-date{font-size:0.8rem;color:var(--text-muted)}
        .feedback-scores{display:flex;gap:8px}
        .score-mini{display:flex;flex-direction:column;align-items:center;gap:2px}
        .score-mini-label{font-size:0.6rem;color:var(--text-muted);text-transform:uppercase}
        .score-mini-value{font-family:'JetBrains Mono',monospace;font-weight:600;font-size:0.9rem}
        .feedback-text{font-size:0.9rem;color:var(--text-secondary);line-height:1.6;font-style:italic}
        .feedback-text.issue{border-left:3px solid var(--accent-red);padding-left:12px;margin-bottom:12px}
        .feedback-text.suggestion{border-left:3px solid var(--accent-cyan);padding-left:12px}
        /* Calendar Styles */
        .calendar-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;margin-bottom:24px}
        .calendar-header{text-align:center;padding:10px;font-size:0.75rem;color:var(--text-muted);text-transform:uppercase;font-weight:600}
        .calendar-day{background:var(--bg-card-hover);border:1px solid var(--border-color);border-radius:8px;min-height:100px;padding:8px}
        .calendar-day.other-month{opacity:0.3}
        .calendar-day.today{border-color:var(--accent-blue);background:rgba(55,66,250,0.1)}
        .calendar-date{font-size:0.85rem;font-weight:600;margin-bottom:6px;font-family:'JetBrains Mono',monospace}
        .calendar-event{font-size:0.7rem;padding:4px 6px;border-radius:4px;margin-bottom:4px;cursor:pointer}
        .calendar-event.roundtable{background:rgba(168,85,247,0.3);color:var(--accent-purple);border-left:2px solid var(--accent-purple)}
        .calendar-event.site-visit{background:rgba(0,255,136,0.2);color:var(--accent-green);border-left:2px solid var(--accent-green)}
        .calendar-event.training{background:rgba(0,212,255,0.2);color:var(--accent-cyan);border-left:2px solid var(--accent-cyan)}
        .calendar-event.deadline{background:rgba(255,71,87,0.2);color:var(--accent-red);border-left:2px solid var(--accent-red)}
        .calendar-event.review{background:rgba(255,165,2,0.2);color:var(--accent-orange);border-left:2px solid var(--accent-orange)}
        .calendar-event.past{opacity:0.7}
        .event-list{margin-top:10px}
        .event-item{display:flex;gap:16px;padding:16px;background:var(--bg-card-hover);border:1px solid var(--border-color);border-radius:12px;margin-bottom:12px;align-items:flex-start}
        .event-item.past{border-left:3px solid var(--text-muted)}
        .event-date-box{background:var(--bg-dark);border-radius:8px;padding:12px;text-align:center;min-width:70px}
        .event-month{font-size:0.7rem;color:var(--accent-cyan);text-transform:uppercase;font-weight:600}
        .event-day{font-size:1.5rem;font-weight:700;font-family:'JetBrains Mono',monospace}
        .event-details{flex:1}
        .event-title{font-size:1rem;font-weight:600;margin-bottom:4px}
        .event-meta{font-size:0.85rem;color:var(--text-secondary)}
        .event-notes{margin-top:10px;padding:12px;background:var(--bg-dark);border-radius:8px;font-size:0.85rem;color:var(--text-secondary);line-height:1.6;border-left:3px solid var(--accent-purple)}
        .event-notes-label{font-size:0.7rem;color:var(--text-muted);text-transform:uppercase;margin-bottom:6px;font-weight:600}
        .event-type{display:inline-block;padding:2px 8px;border-radius:10px;font-size:0.7rem;font-weight:600;margin-left:8px}
        .no-events{text-align:center;padding:40px;color:var(--text-muted);font-style:italic}
        .legend{display:flex;gap:16px;flex-wrap:wrap;margin-bottom:20px}
        .legend-item{display:flex;align-items:center;gap:6px;font-size:0.8rem;color:var(--text-secondary)}
        .legend-dot{width:12px;height:12px;border-radius:3px}
        .roundtable-section{margin-bottom:24px}
        .roundtable-header{display:flex;align-items:center;gap:12px;margin-bottom:16px;padding-bottom:12px;border-bottom:1px solid var(--border-color)}
        .roundtable-station{font-size:1.1rem;font-weight:700;font-family:'JetBrains Mono',monospace}
        .roundtable-date{font-size:0.85rem;color:var(--text-muted)}
        .action-item-row{display:flex;gap:12px;padding:12px;background:var(--bg-card-hover);border-radius:8px;margin-bottom:8px;align-items:flex-start}
        .action-item-row:hover{background:rgba(55,66,250,0.1)}
        .action-checkbox{width:20px;height:20px;border:2px solid var(--border-color);border-radius:4px;flex-shrink:0;margin-top:2px;cursor:pointer}
        .action-checkbox.done{background:var(--accent-green);border-color:var(--accent-green)}
        .action-owner{font-size:0.75rem;color:var(--accent-purple);font-weight:600;text-transform:uppercase;min-width:80px;flex-shrink:0}
        .action-text{font-size:0.9rem;color:var(--text-secondary);flex:1}
        .action-status{font-size:0.7rem;padding:3px 8px;border-radius:10px;font-weight:600}
        .action-status.pending{background:rgba(255,165,2,0.2);color:var(--accent-orange)}
        .action-status.done{background:rgba(0,255,136,0.2);color:var(--accent-green)}
        @media(max-width:1200px){.kpi-row{grid-template-columns:repeat(3,1fr)}.action-list{grid-template-columns:repeat(2,1fr)}.insights-grid{grid-template-columns:1fr}.calendar-grid{grid-template-columns:repeat(7,1fr)}}
        @media(max-width:900px){.main-grid{grid-template-columns:1fr}.kpi-row{grid-template-columns:repeat(2,1fr)}.action-list{grid-template-columns:1fr}}
        @media(max-width:600px){.header{flex-direction:column;gap:16px}.kpi-row{grid-template-columns:1fr}.nav-tabs{flex-wrap:wrap}.calendar-day{min-height:60px}}
    </style>
</head>
<body>
    <div class="bg-grid"></div>
    <div class="container">
        <header class="header">
            <div class="header-left">
                <h1>Kooner Adoption Dashboard</h1>
                <div class="subtitle"><span>Vendor Adoption Tracking</span><span class="target-badge">TARGET: 85%</span></div>
            </div>
            <div class="header-right">
                <div class="last-updated">Last Updated: 2026-02-11</div>
                <div class="data-period">Data Period: WK01 - WK06 (Dec 28 - Feb 7)</div>
            </div>
        </header>
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('overview')">üìä Overview</button>
            <button class="nav-tab" onclick="showTab('trends')">üìà Week-over-Week</button>
            <button class="nav-tab" onclick="showTab('stations')">üè¢ Stations</button>
            <button class="nav-tab" onclick="showTab('dsps')">üöõ DSPs</button>
            <button class="nav-tab" onclick="showTab('sentiment')">üí¨ DSP Sentiment</button>
            <button class="nav-tab" onclick="showTab('actions')">üéØ Actions</button>
            <button class="nav-tab" onclick="showTab('calendar')">üìÖ Calendar</button>
        </div>

        <div id="overview" class="tab-content active">
            <div class="kpi-row">
                <div class="kpi-card"><div class="kpi-label">Total Kooner WOs</div><div class="kpi-value green">726</div><div class="kpi-subtext">Completed by Kooner</div></div>
                <div class="kpi-card warning"><div class="kpi-label">Total Leaked WOs</div><div class="kpi-value orange">594</div><div class="kpi-subtext">Sent to other vendors</div></div>
                <div class="kpi-card danger"><div class="kpi-label">Current Adoption</div><div class="kpi-value red">46.0%</div><div class="kpi-subtext">39.0% gap to target</div></div>
                <div class="kpi-card success"><div class="kpi-label">On Target Stations</div><div class="kpi-value green">3</div><div class="kpi-subtext">of 13 stations ‚â•85%</div></div>
                <div class="kpi-card"><div class="kpi-label">Total WOs</div><div class="kpi-value">1,320</div><div class="kpi-subtext">Across 13 stations</div></div>
            </div>
            <div class="main-grid">
                <div class="card"><div class="card-header"><div class="card-title">Weekly Kooner Volume</div><span class="card-badge badge-trends">WK01-WK06</span></div><div class="chart-container"><canvas id="weeklyBarChart"></canvas></div></div>
                <div class="card"><div class="card-header"><div class="card-title">Station Adoption Distribution</div></div><div class="chart-container"><canvas id="stationBarChart"></canvas></div></div>
                <div class="card"><div class="card-header"><div class="card-title">Station Status</div><span class="card-badge badge-stations">13 STATIONS</span></div><div class="table-scroll" style="max-height:300px"><table class="data-table"><thead><tr><th>Station</th><th>Adoption</th><th>Kooner</th><th>Leaked</th><th>Status</th></tr></thead><tbody id="stationQuickTable"></tbody></table></div></div>
                <div class="card"><div class="card-header"><div class="card-title">Top Opportunities</div><span class="card-badge badge-dsps">BY LEAKED WOs</span></div><div class="table-scroll" style="max-height:300px"><table class="data-table"><thead><tr><th>Station</th><th>Leaked</th><th>Adoption</th><th>Potential</th></tr></thead><tbody id="opportunityTable"></tbody></table></div></div>
            </div>
        </div>

        <div id="trends" class="tab-content">
            <div class="main-grid">
                <div class="card full-width">
                    <div class="card-header"><div class="card-title">üìã WBR Executive Summary</div><span class="card-badge badge-insights">WK06 DATA</span></div>
                    <div class="executive-summary">
                        <h3>üéØ Key Takeaways</h3>
                        <ul>
                            <li><strong>Overall adoption at 46.0% (Amazon official)</strong> ‚Äî 39% below the 85% target. WK06 shows +4% WoW improvement.</li>
                            <li><strong>3 stations meeting target:</strong> HMK4 (100%), HSL1 (100%), HCT2 (87.0%)</li>
                            <li><strong>HLA2 is the largest opportunity:</strong> 225 leaked WOs (38% of all leakage), only 40.3% adoption.</li>
                            <li><strong>HDT3 has highest volume</strong> but only 51.8% adoption with 120 leaked WOs.</li>
                            <li><strong>HPD1 is critical:</strong> Only 3.0% adoption (1 Kooner vs 32 leaked).</li>
                        </ul>
                    </div>
                    <div class="insights-grid">
                        <div class="insight-card positive"><div class="insight-icon">‚úÖ</div><div class="insight-title">On Target Stations</div><div class="insight-text"><span class="insight-metric">HMK4, HSL1, HCT2</span> ‚Äî 3 stations meeting 85%+ target.</div></div>
                        <div class="insight-card negative"><div class="insight-icon">üî¥</div><div class="insight-title">Critical: HPD1</div><div class="insight-text"><span class="insight-metric">3.0% adoption</span> ‚Äî Only 1 Kooner WO vs 32 leaked.</div></div>
                        <div class="insight-card warning"><div class="insight-icon">üéØ</div><div class="insight-title">Biggest Opportunity: HLA2</div><div class="insight-text"><span class="insight-metric">225 leaked WOs</span> ‚Äî 38% of total leakage.</div></div>
                        <div class="insight-card info"><div class="insight-icon">üìä</div><div class="insight-title">Near Target</div><div class="insight-text"><span class="insight-metric">HDY1 (81.7%), HTP2 (79.8%), HHO3 (79.2%)</span></div></div>
                    </div>
                </div>
                <div class="card full-width"><div class="card-header"><div class="card-title">üìà Weekly Kooner Volume by Station</div></div><div class="chart-container tall"><canvas id="stationWeeklyChart"></canvas></div></div>
                <div class="card full-width"><div class="card-header"><div class="card-title">Station Weekly Breakdown</div></div><div class="table-scroll"><table class="data-table"><thead><tr><th>Station</th><th>WK1</th><th>WK2</th><th>WK3</th><th>WK4</th><th>WK5</th><th>WK6</th><th>Total</th></tr></thead><tbody id="stationWeeklyTable"></tbody></table></div></div>
            </div>
        </div>

        <div id="stations" class="tab-content">
            <div class="main-grid">
                <div class="card full-width"><div class="card-header"><div class="card-title">Station Adoption Details</div><span class="card-badge badge-stations">13 STATIONS</span></div><table class="data-table"><thead><tr><th>Station</th><th>Location</th><th>Adoption</th><th>Kooner</th><th>Leaked</th><th>Total</th><th>Gap to 85%</th><th>Status</th></tr></thead><tbody id="stationFullTable"></tbody></table></div>
                <div class="card"><div class="card-header"><div class="card-title">Station Rankings</div></div><div class="chart-container tall"><canvas id="stationRankChart"></canvas></div></div>
                <div class="card"><div class="card-header"><div class="card-title">Leakage Distribution</div></div><div class="chart-container tall"><canvas id="leakageChart"></canvas></div></div>
            </div>
        </div>

        <div id="dsps" class="tab-content">
            <div class="main-grid">
                <div class="card full-width">
                    <div class="card-header"><div class="card-title">DSP Priority List</div><span class="card-badge badge-dsps">BY STATION</span></div>
                    <div class="filter-row">
                        <button class="filter-btn active" onclick="filterStations('all',this)">All Stations</button>
                        <button class="filter-btn" onclick="filterStations('HLA2',this)">HLA2</button>
                        <button class="filter-btn" onclick="filterStations('HDT3',this)">HDT3</button>
                        <button class="filter-btn" onclick="filterStations('HAU1',this)">HAU1</button>
                        <button class="filter-btn" onclick="filterStations('HCL2',this)">HCL2</button>
                        <button class="filter-btn" onclick="filterStations('HPD1',this)">HPD1</button>
                    </div>
                    <div class="table-scroll" style="max-height:500px"><table class="data-table"><thead><tr><th>Station</th><th>Adoption</th><th>Kooner</th><th>Leaked</th><th>Opportunity</th><th>Priority</th></tr></thead><tbody id="dspTable"></tbody></table></div>
                </div>
            </div>
        </div>

        <div id="sentiment" class="tab-content">
            <div class="kpi-row" style="grid-template-columns:repeat(4,1fr)">
                <div class="kpi-card"><div class="kpi-label">Survey Responses</div><div class="kpi-value">14</div><div class="kpi-subtext">From 7 DSPs</div></div>
                <div class="kpi-card warning"><div class="kpi-label">Avg Satisfaction</div><div class="kpi-value yellow">2.8</div><div class="kpi-subtext">out of 5.0</div></div>
                <div class="kpi-card warning"><div class="kpi-label">Avg Timeliness</div><div class="kpi-value orange">2.8</div><div class="kpi-subtext">out of 5.0</div></div>
                <div class="kpi-card warning"><div class="kpi-label">Avg Quality</div><div class="kpi-value orange">2.9</div><div class="kpi-subtext">out of 5.0</div></div>
            </div>
            <div class="main-grid">
                <div class="card"><div class="card-header"><div class="card-title">Sentiment by DSP</div></div><div class="chart-container"><canvas id="sentimentChart"></canvas></div></div>
                <div class="card"><div class="card-header"><div class="card-title">Sentiment vs Adoption</div></div><div class="chart-container"><canvas id="correlationChart"></canvas></div></div>
                <div class="card full-width"><div class="card-header"><div class="card-title">üéØ Key Themes</div></div><div class="insights-grid"><div class="insight-card negative"><div class="insight-icon">‚è±Ô∏è</div><div class="insight-title">Timeliness</div><div class="insight-text">PM completion 4+ days</div></div><div class="insight-card negative"><div class="insight-icon">üìÑ</div><div class="insight-title">Paperwork</div><div class="insight-text">Documentation delays</div></div><div class="insight-card warning"><div class="insight-icon">üí¨</div><div class="insight-title">Communication</div><div class="insight-text">Need proactive updates</div></div><div class="insight-card positive"><div class="insight-icon">üåü</div><div class="insight-title">ARMA Turnaround!</div><div class="insight-text">Feb 9: 5/5 - "Jose Madrigal is GREAT!"</div></div></div></div>
                <div class="card full-width"><div class="card-header"><div class="card-title">üí¨ Recent Feedback</div></div><div id="feedbackList"></div></div>
            </div>
        </div>

        <div id="actions" class="tab-content">
            <div class="kpi-row" style="grid-template-columns:repeat(4,1fr)">
                <div class="kpi-card danger"><div class="kpi-label">Critical Priority</div><div class="kpi-value red">3</div><div class="kpi-subtext">Immediate action needed</div></div>
                <div class="kpi-card warning"><div class="kpi-label">High Priority</div><div class="kpi-value orange">4</div><div class="kpi-subtext">Address this week</div></div>
                <div class="kpi-card"><div class="kpi-label">Roundtable Actions</div><div class="kpi-value yellow">13</div><div class="kpi-subtext">From recent meetings</div></div>
                <div class="kpi-card success"><div class="kpi-label">Improving</div><div class="kpi-value green">2</div><div class="kpi-subtext">Positive trend</div></div>
            </div>
            <div class="main-grid">
                <div class="card full-width"><div class="card-header"><div class="card-title">üéØ Priority Actions (Adoption + Sentiment)</div><span class="card-badge badge-sentiment">COMBINED SCORING</span></div><div class="action-list" id="actionList"></div></div>
                <div class="card full-width"><div class="card-header"><div class="card-title">üìã Action Matrix</div></div><table class="data-table"><thead><tr><th>Priority</th><th>Station</th><th>Adoption</th><th>Sentiment</th><th>Leaked</th><th>Key Issue</th><th>Recommended Action</th></tr></thead><tbody id="actionTable"></tbody></table></div>
                <div class="card full-width"><div class="card-header"><div class="card-title">üìÖ Roundtable Action Items</div><span class="card-badge badge-calendar">FROM MEETINGS</span></div><div id="roundtableActions"></div></div>
            </div>
        </div>

        <div id="calendar" class="tab-content">
            <div class="main-grid">
                <div class="card full-width">
                    <div class="card-header"><div class="card-title">üìÖ February 2026</div><span class="card-badge badge-calendar">ENGAGEMENT CALENDAR</span></div>
                    <div class="legend">
                        <div class="legend-item"><div class="legend-dot" style="background:rgba(168,85,247,0.5)"></div>DSP Roundtable</div>
                        <div class="legend-item"><div class="legend-dot" style="background:rgba(0,255,136,0.5)"></div>Site Visit</div>
                        <div class="legend-item"><div class="legend-dot" style="background:rgba(0,212,255,0.5)"></div>Training</div>
                        <div class="legend-item"><div class="legend-dot" style="background:rgba(255,71,87,0.5)"></div>Deadline</div>
                        <div class="legend-item"><div class="legend-dot" style="background:rgba(255,165,2,0.5)"></div>Review</div>
                    </div>
                    <div class="calendar-grid" id="calendarGrid"></div>
                </div>
                <div class="card">
                    <div class="card-header"><div class="card-title">üìã Upcoming Events</div></div>
                    <div class="event-list" id="eventList"></div>
                </div>
                <div class="card">
                    <div class="card-header"><div class="card-title">üìù Past Event Notes</div><span class="card-badge badge-dsps">ROUNDTABLE NOTES</span></div>
                    <div class="event-list" id="pastEventList"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        var stationData = [
            {station:'HMK4',location:'Milwaukee, WI',kooner:57,leaked:0,adoption:100.0},
            {station:'HSL1',location:'Salt Lake City, UT',kooner:20,leaked:0,adoption:100.0},
            {station:'HCT2',location:'Chattanooga, TN',kooner:20,leaked:3,adoption:87.0},
            {station:'HDY1',location:'Clayton, OH',kooner:49,leaked:11,adoption:81.7},
            {station:'HTP2',location:'Gibsonton, FL',kooner:67,leaked:17,adoption:79.8},
            {station:'HHO3',location:'Porter, TX',kooner:84,leaked:22,adoption:79.2},
            {station:'HMS2',location:'Lakeville, MN',kooner:35,leaked:27,adoption:56.5},
            {station:'HDT3',location:'Romulus, MI',kooner:129,leaked:120,adoption:51.8},
            {station:'HCL2',location:'Charlotte, NC',kooner:54,leaked:51,adoption:51.4},
            {station:'HIN3',location:'South Bend, IN',kooner:11,leaked:15,adoption:42.3},
            {station:'HLA2',location:'Santa Clarita, CA',kooner:152,leaked:225,adoption:40.3},
            {station:'HAU1',location:'Austin, TX',kooner:47,leaked:71,adoption:39.8},
            {station:'HPD1',location:'Portland, OR',kooner:1,leaked:32,adoption:3.0}
        ];

        var weeklyByStation = {
            'HAU1':{WK1:6,WK2:12,WK3:10,WK4:14,WK5:3,WK6:null,total:47},
            'HCL2':{WK1:1,WK2:5,WK3:29,WK4:8,WK5:10,WK6:null,total:54},
            'HCT2':{WK1:null,WK2:4,WK3:5,WK4:7,WK5:2,WK6:null,total:20},
            'HDT3':{WK1:9,WK2:15,WK3:17,WK4:26,WK5:44,WK6:null,total:129},
            'HDY1':{WK1:9,WK2:20,WK3:10,WK4:6,WK5:null,WK6:null,total:49},
            'HHO3':{WK1:6,WK2:22,WK3:13,WK4:19,WK5:15,WK6:null,total:84},
            'HIN3':{WK1:1,WK2:5,WK3:4,WK4:2,WK5:null,WK6:null,total:11},
            'HLA2':{WK1:9,WK2:20,WK3:23,WK4:42,WK5:41,WK6:null,total:152},
            'HMK4':{WK1:10,WK2:8,WK3:15,WK4:3,WK5:14,WK6:null,total:57},
            'HMS2':{WK1:2,WK2:6,WK3:5,WK4:11,WK5:9,WK6:null,total:35},
            'HPD1':{WK1:null,WK2:null,WK3:null,WK4:1,WK5:null,WK6:null,total:1},
            'HSL1':{WK1:1,WK2:4,WK3:5,WK4:5,WK5:5,WK6:null,total:20},
            'HTP2':{WK1:3,WK2:20,WK3:8,WK4:16,WK5:7,WK6:null,total:67}
        };

        var weekTotals = {WK1:58,WK2:140,WK3:140,WK4:159,WK5:153,WK6:148};

        var sentimentData = [
            {dsp:"ALAB",station:"HDT3",responses:1,satisfaction:1.0,timeliness:1.0,quality:1.0,avgScore:1.0,adoption:51.8},
            {dsp:"ARMA",station:"HLA2",responses:5,satisfaction:2.6,timeliness:2.6,quality:2.6,avgScore:2.6,adoption:40.3},
            {dsp:"ORMP",station:"HTP2",responses:2,satisfaction:2.0,timeliness:2.0,quality:3.0,avgScore:2.3,adoption:79.8},
            {dsp:"MAEP",station:"HIN3",responses:1,satisfaction:2.0,timeliness:2.0,quality:3.0,avgScore:2.3,adoption:42.3},
            {dsp:"SFRM",station:"HDT3",responses:3,satisfaction:3.3,timeliness:3.0,quality:3.0,avgScore:3.1,adoption:51.8},
            {dsp:"PRLC",station:"HSL1",responses:1,satisfaction:4.0,timeliness:5.0,quality:3.0,avgScore:4.0,adoption:100},
            {dsp:"D4DS",station:"HCL2",responses:1,satisfaction:5.0,timeliness:5.0,quality:5.0,avgScore:5.0,adoption:51.4}
        ];

        var feedbackData = [
            {date:"Feb 10",dsp:"SFRM",station:"HDT3",satisfaction:4,timeliness:4,quality:4,issue:"Unit 2974 pending diagnostics for a few days",suggestion:"More availability for weekend issues, over the road calls."},
            {date:"Feb 9",dsp:"ORMP",station:"HTP2",satisfaction:2,timeliness:2,quality:4,issue:"Multiple WOs not looked at since 2/4. Helpful contact laid off.",suggestion:""},
            {date:"Feb 9",dsp:"ARMA",station:"HLA2",satisfaction:5,timeliness:5,quality:5,issue:"",suggestion:"Jose Madrigal is GREAT! Very professional and attentive."},
            {date:"Feb 2",dsp:"SFRM",station:"HDT3",satisfaction:3,timeliness:3,quality:3,issue:"",suggestion:"Need 2 day techs. Better communication."},
            {date:"Jan 26",dsp:"ALAB",station:"HDT3",satisfaction:1,timeliness:1,quality:1,issue:"Lack of timely repairs. Same issue after ungrounding.",suggestion:"Timely repairs needed."},
            {date:"Jan 12",dsp:"D4DS",station:"HCL2",satisfaction:5,timeliness:5,quality:5,issue:"",suggestion:"Supervisor got more vehicles running in one evening than any mechanic in 5 years."},
            {date:"Jan 6",dsp:"ORMP",station:"HTP2",satisfaction:2,timeliness:2,quality:2,issue:"No paperwork after 7 days. Brakes still bad.",suggestion:"Need schedule access."},
            {date:"Jan 5",dsp:"ARMA",station:"HLA2",satisfaction:1,timeliness:1,quality:1,issue:"No work orders submitted.",suggestion:"Better communication."}
        ];

        // Combined action data with sentiment
        var actionData = [
            {station:'HPD1',location:'Portland, OR',adoption:3.0,leaked:32,sentiment:null,issue:'No survey data - unknown DSP engagement',action:'Emergency: Identify DSP contacts, schedule immediate roundtable',priority:'critical'},
            {station:'HLA2',location:'Santa Clarita, CA',adoption:40.3,leaked:225,sentiment:2.6,issue:'ARMA improving (5/5 recent), but historical issues',action:'Continue momentum with Jose M. Expand to other DSPs at station',priority:'critical'},
            {station:'HAU1',location:'Austin, TX',adoption:39.8,leaked:71,sentiment:null,issue:'No survey data - dropped from 88% to 40%',action:'Urgent site visit to identify root cause of decline',priority:'critical'},
            {station:'HDT3',location:'Romulus, MI',adoption:51.8,leaked:120,sentiment:2.1,issue:'ALAB (1/5) and SFRM (3.1/5) mixed feedback',action:'Address ALAB concerns first - timeliness and rework issues',priority:'high'},
            {station:'HIN3',location:'South Bend, IN',adoption:42.3,leaked:15,sentiment:2.3,issue:'MAEP reports unresolved issues, wrong parts',action:'Quality review with tech team, parts inventory check',priority:'high'},
            {station:'HCL2',location:'Charlotte, NC',adoption:51.4,leaked:51,sentiment:5.0,issue:'D4DS loves service but adoption still low',action:'Identify other DSPs at station causing leakage',priority:'high'},
            {station:'HTP2',location:'Gibsonton, FL',adoption:79.8,leaked:17,sentiment:2.3,issue:'ORMP: contact laid off, no visibility into WOs',action:'Assign new contact, improve communication cadence',priority:'high'},
            {station:'HMS2',location:'Lakeville, MN',adoption:56.5,leaked:27,sentiment:null,issue:'No survey data',action:'Schedule DSP roundtable to gather feedback',priority:'medium'},
            {station:'HHO3',location:'Porter, TX',adoption:79.2,leaked:22,sentiment:null,issue:'Near target but no survey feedback',action:'Quick wins to push over 85%, gather DSP input',priority:'medium'},
            {station:'HDY1',location:'Clayton, OH',adoption:81.7,leaked:11,sentiment:null,issue:'Very close to target',action:'Final push to 85% - identify remaining blockers',priority:'low'}
        ];

        // Calendar events
        var calendarEvents = [
            {date:'2026-02-09',title:'HMS2 Roundtable',type:'roundtable',station:'HMS2',time:'10:00 AM',notes:'<strong>Key Issues:</strong> Severe communication delays - questions unanswered 6-8 hrs, multi-day gaps despite 60-80 people in Kooner chat. Steven: "Never experienced such delay" vs prior vendors.<br><br><strong>Safety/Compliance Failures:</strong> Truck 21 passed Federal DOT but failed MN inspection with visible drag link issues. Truck 20 had 5 federal DOT failures caught by external shop. Wrong stickers on wrong vehicles. Steven: "Would rather pay out of pocket for inspections."<br><br><strong>Work Quality:</strong> Truck 1 urgent WO at 8am, tech sat idle until 12:15pm. WOs marked complete when repairs not finished. Multiple recreations needed.<br><br><strong>Root Causes:</strong> Coverage gaps across shifts, tech (Michael) attendance/training issues, no escalation protocols, DSPs unclear on contacts.<br><br><strong>Solutions Discussed:</strong> David (experienced manager tech) deploying next week for training/oversight. Formal dispatch schedule being created. This is 2nd escalation - relationship at risk.<br><br><strong style="color:#ff4757">Action Items:</strong><br>‚Ä¢ Brooke/Alberto: Provide direct numbers for 24/7 contact<br>‚Ä¢ Ash: Send dispatch schedule with roles/coverage times<br>‚Ä¢ David: Visit HMS2 next week for training & process review<br>‚Ä¢ Steven: Document VINs, dates, WO details via email + chat<br>‚Ä¢ Team: Schedule site visit after David training complete<br>‚Ä¢ Team: Establish escalation protocols for urgent repairs<br>‚Ä¢ Team: Implement follow-up tracking for all issues'},
            {date:'2026-02-10',title:'HCL2 Roundtable',type:'roundtable',station:'HCL2',time:'2:00 PM',notes:'<strong>Key Issues:</strong> D4DS (Andrea) down to 6 of 17 trucks. Multiple vehicles grounded due to incomplete PMs - one sitting since Jan 22. Communication breakdown: no responses since Saturday, messages unanswered for days. Unexpected tech departure caused service disruption.<br><br><strong>Root Causes:</strong> No proactive status updates, parts availability delays, badge access issues, two intake systems creating confusion, no real-time WO visibility for DSPs.<br><br><strong>Solutions Discussed:</strong> Justin Ellis relocating permanently (6pm-2am shift), Eugene deploying to help clear backlog. Relay Garage integration planned for mid-March with Fleet Portal scheduling.<br><br><strong style="color:#ff4757">Action Items:</strong><br>‚Ä¢ Ash: Provide cell numbers for direct contact<br>‚Ä¢ Ash: Daily AM updates in Chime on overnight completions<br>‚Ä¢ Kathy: Send contact list with roles<br>‚Ä¢ Team: Provide ETA doc for all 28 open WOs<br>‚Ä¢ Mark: Meet Justin to set up vehicle shuttle system<br>‚Ä¢ Mark: Set up key box at FC entrance<br>‚Ä¢ Andrea: Share D4 WOs in Chime for reconciliation'},
            {date:'2026-02-11',title:'HPD1 Roundtable',type:'roundtable',station:'HPD1',time:'11:00 AM',notes:'<strong>Pre-Meeting Context (from Ryan Sager email):</strong><br>‚Ä¢ Only 8 repair orders created with Kooner since launch<br>‚Ä¢ Smaller fleet: &lt;16 branded vehicles<br>‚Ä¢ DSP (Robert) was "okay" with mobile service but not using Kooner for all repairs<br><br><strong>Known Issues:</strong><br>‚Ä¢ Invoice/DOT documents moved to BOX without DSP awareness - caused delay getting vehicle back operational<br>‚Ä¢ Some issues with scheduling service and getting timeline updates<br>‚Ä¢ Issues mostly fixed quickly by assistants per Ryan, but DSP may have more to share<br><br><strong>Key Question:</strong> Why aren\'t they using Kooner for all repairs?<br><br><strong>Attendees:</strong> Robert (DSP), Ryan Sager (Amazon Sr. PM), Brooke, Kooner team<br><br><em>Add meeting notes and action items after roundtable...</em>'}
        ];

        // Roundtable action items for Actions tab
        var roundtableActions = [
            {station:'HMS2',date:'Feb 9',owner:'Brooke/Alberto',action:'Provide direct numbers for 24/7 contact',status:'pending'},
            {station:'HMS2',date:'Feb 9',owner:'Ash',action:'Send dispatch schedule with roles/coverage times',status:'pending'},
            {station:'HMS2',date:'Feb 9',owner:'David',action:'Visit HMS2 next week for training & process review',status:'pending'},
            {station:'HMS2',date:'Feb 9',owner:'Steven',action:'Document VINs, dates, WO details via email + chat',status:'pending'},
            {station:'HMS2',date:'Feb 9',owner:'Team',action:'Schedule site visit after David training complete',status:'pending'},
            {station:'HMS2',date:'Feb 9',owner:'Team',action:'Establish escalation protocols for urgent repairs',status:'pending'},
            {station:'HCL2',date:'Feb 10',owner:'Ash',action:'Provide cell numbers for direct contact',status:'pending'},
            {station:'HCL2',date:'Feb 10',owner:'Ash',action:'Daily AM updates in Chime on overnight completions',status:'pending'},
            {station:'HCL2',date:'Feb 10',owner:'Kathy',action:'Send contact list with roles',status:'pending'},
            {station:'HCL2',date:'Feb 10',owner:'Team',action:'Provide ETA doc for all 28 open WOs',status:'pending'},
            {station:'HCL2',date:'Feb 10',owner:'Mark',action:'Meet Justin to set up vehicle shuttle system',status:'pending'},
            {station:'HCL2',date:'Feb 10',owner:'Mark',action:'Set up key box at FC entrance',status:'pending'},
            {station:'HCL2',date:'Feb 10',owner:'Andrea',action:'Share D4 WOs in Chime for reconciliation',status:'pending'}
        ];

        function showTab(tabId){
            document.querySelectorAll('.tab-content').forEach(function(c){c.classList.remove('active')});
            document.querySelectorAll('.nav-tab').forEach(function(t){t.classList.remove('active')});
            document.getElementById(tabId).classList.add('active');
            event.target.classList.add('active');
        }

        function filterStations(filter,btn){
            document.querySelectorAll('.filter-btn').forEach(function(b){b.classList.remove('active')});
            btn.classList.add('active');
            populateDSPTable(filter);
        }

        function getScoreColor(s){if(s>=4)return'var(--accent-green)';if(s>=3)return'var(--accent-yellow)';if(s>=2)return'var(--accent-orange)';return'var(--accent-red)'}
        function getScoreClass(s){if(s>=4)return'score-'+Math.round(s);if(s>=3)return'score-3';if(s>=2)return'score-2';return'score-1'}

        function populateStationQuickTable(){
            var t=document.getElementById('stationQuickTable'),h='';
            var sorted=stationData.slice().sort(function(a,b){return b.adoption-a.adoption});
            for(var i=0;i<sorted.length;i++){var s=sorted[i],ot=s.adoption>=85;
            h+='<tr><td><span class="station-name">'+s.station+'</span></td><td style="color:'+(ot?'var(--accent-green)':'var(--accent-red)')+'">'+s.adoption.toFixed(1)+'%</td><td>'+s.kooner+'</td><td>'+s.leaked+'</td><td><span class="status-pill '+(ot?'on-target':'below-target')+'"><span class="status-dot"></span>'+(ot?'On Target':'Below')+'</span></td></tr>';}
            t.innerHTML=h;
        }

        function populateOpportunityTable(){
            var t=document.getElementById('opportunityTable'),h='';
            var sorted=stationData.slice().filter(function(s){return s.leaked>0}).sort(function(a,b){return b.leaked-a.leaked});
            for(var i=0;i<Math.min(sorted.length,8);i++){var s=sorted[i];
            var potential=((s.kooner+s.leaked)/(726+594)*100).toFixed(1);
            h+='<tr><td><span class="station-name">'+s.station+'</span></td><td style="color:var(--accent-red)">'+s.leaked+'</td><td>'+s.adoption.toFixed(1)+'%</td><td>'+potential+'% of total</td></tr>';}
            t.innerHTML=h;
        }

        function populateStationFullTable(){
            var t=document.getElementById('stationFullTable'),h='';
            var sorted=stationData.slice().sort(function(a,b){return b.adoption-a.adoption});
            for(var i=0;i<sorted.length;i++){var s=sorted[i],ot=s.adoption>=85,gap=85-s.adoption,total=s.kooner+s.leaked;
            h+='<tr><td><span class="station-name">'+s.station+'</span></td><td>'+(s.location||'‚Äî')+'</td><td style="color:'+(ot?'var(--accent-green)':'var(--accent-red)')+'">'+s.adoption.toFixed(1)+'%</td><td>'+s.kooner+'</td><td>'+s.leaked+'</td><td>'+total+'</td><td style="color:'+(gap>0?'var(--accent-red)':'var(--accent-green)')+'">'+(gap>0?'+':'')+gap.toFixed(1)+'%</td><td><span class="status-pill '+(ot?'on-target':'below-target')+'"><span class="status-dot"></span>'+(ot?'On Target':'Below')+'</span></td></tr>';}
            t.innerHTML=h;
        }

        function populateStationWeeklyTable(){
            var t=document.getElementById('stationWeeklyTable'),h='';
            var stations=Object.keys(weeklyByStation).sort(function(a,b){return weeklyByStation[b].total-weeklyByStation[a].total});
            for(var i=0;i<stations.length;i++){var st=stations[i],w=weeklyByStation[st];
            h+='<tr><td><span class="station-name">'+st+'</span></td><td>'+(w.WK1||'‚Äî')+'</td><td>'+(w.WK2||'‚Äî')+'</td><td>'+(w.WK3||'‚Äî')+'</td><td>'+(w.WK4||'‚Äî')+'</td><td>'+(w.WK5||'‚Äî')+'</td><td>'+(w.WK6||'‚Äî')+'</td><td><strong>'+w.total+'</strong></td></tr>';}
            h+='<tr style="background:var(--bg-card-hover)"><td><strong>TOTAL</strong></td><td><strong>'+weekTotals.WK1+'</strong></td><td><strong>'+weekTotals.WK2+'</strong></td><td><strong>'+weekTotals.WK3+'</strong></td><td><strong>'+weekTotals.WK4+'</strong></td><td><strong>'+weekTotals.WK5+'</strong></td><td><strong>'+weekTotals.WK6+'</strong></td><td><strong>798</strong></td></tr>';
            t.innerHTML=h;
        }

        function populateDSPTable(filter){
            filter=filter||'all';var t=document.getElementById('dspTable'),h='';
            var filtered=filter==='all'?stationData:stationData.filter(function(s){return s.station===filter});
            filtered=filtered.slice().sort(function(a,b){return b.leaked-a.leaked});
            for(var i=0;i<filtered.length;i++){var s=filtered[i];if(s.leaked===0)continue;
            var priority=s.adoption<20?'critical':s.adoption<50?'high':s.adoption<70?'medium':'low';
            var opp=(s.leaked/594*100).toFixed(1);
            h+='<tr><td><span class="station-name">'+s.station+'</span></td><td style="color:'+(s.adoption>=85?'var(--accent-green)':'var(--accent-red)')+'">'+s.adoption.toFixed(1)+'%</td><td>'+s.kooner+'</td><td>'+s.leaked+'</td><td>'+opp+'% of leakage</td><td><span class="priority-pill priority-'+priority+'">'+priority+'</span></td></tr>';}
            t.innerHTML=h;
        }

        function populateActionCards(){
            var c=document.getElementById('actionList'),h='';
            var sorted=actionData.slice().sort(function(a,b){
                var po={critical:0,high:1,medium:2,low:3};
                return po[a.priority]-po[b.priority];
            }).slice(0,6);
            for(var i=0;i<sorted.length;i++){var a=sorted[i];
            var sentimentHtml=a.sentiment?'<div class="action-stat"><span class="action-stat-label">Sentiment</span><span class="action-stat-value '+(a.sentiment>=3?'green':a.sentiment>=2?'orange':'red')+'">'+a.sentiment.toFixed(1)+'/5</span></div>':'<div class="action-stat"><span class="action-stat-label">Sentiment</span><span class="action-stat-value" style="color:var(--text-muted)">No data</span></div>';
            h+='<div class="action-card '+a.priority+'"><div class="action-header"><span class="action-dsp">'+a.station+'</span><span class="priority-pill priority-'+a.priority+'">'+a.priority+'</span></div><div class="action-stats"><div class="action-stat"><span class="action-stat-label">Adoption</span><span class="action-stat-value red">'+a.adoption.toFixed(1)+'%</span></div><div class="action-stat"><span class="action-stat-label">Leaked</span><span class="action-stat-value orange">'+a.leaked+'</span></div>'+sentimentHtml+'</div><div class="action-feedback">üí° '+a.action+'</div></div>';}
            c.innerHTML=h;
        }

        function populateActionTable(){
            var t=document.getElementById('actionTable'),h='';
            for(var i=0;i<actionData.length;i++){var a=actionData[i];
            var sentimentHtml=a.sentiment?'<span class="sentiment-score '+getScoreClass(a.sentiment)+'">'+a.sentiment.toFixed(1)+'</span>':'<span style="color:var(--text-muted)">‚Äî</span>';
            h+='<tr><td><span class="priority-pill priority-'+a.priority+'">'+a.priority+'</span></td><td><span class="station-name">'+a.station+'</span><br><span style="font-size:0.75rem;color:var(--text-muted)">'+a.location+'</span></td><td style="color:'+(a.adoption>=85?'var(--accent-green)':'var(--accent-red)')+'">'+a.adoption.toFixed(1)+'%</td><td>'+sentimentHtml+'</td><td>'+a.leaked+'</td><td style="font-size:0.85rem;color:var(--text-secondary)">'+a.issue+'</td><td style="font-size:0.85rem">'+a.action+'</td></tr>';}
            t.innerHTML=h;
        }

        function populateFeedbackList(){
            var c=document.getElementById('feedbackList'),h='';
            for(var i=0;i<feedbackData.length;i++){var f=feedbackData[i];
            h+='<div class="feedback-card"><div class="feedback-header"><div class="feedback-meta"><span class="station-name">'+f.dsp+'</span><span class="action-station">'+f.station+'</span><span class="feedback-date">'+f.date+'</span></div><div class="feedback-scores"><div class="score-mini"><span class="score-mini-label">Sat</span><span class="score-mini-value" style="color:'+getScoreColor(f.satisfaction)+'">'+f.satisfaction+'</span></div><div class="score-mini"><span class="score-mini-label">Time</span><span class="score-mini-value" style="color:'+getScoreColor(f.timeliness)+'">'+f.timeliness+'</span></div><div class="score-mini"><span class="score-mini-label">Qual</span><span class="score-mini-value" style="color:'+getScoreColor(f.quality)+'">'+f.quality+'</span></div></div></div>';
            if(f.issue)h+='<div class="feedback-text issue"><strong>Issue:</strong> '+f.issue+'</div>';
            if(f.suggestion)h+='<div class="feedback-text suggestion"><strong>Feedback:</strong> '+f.suggestion+'</div>';
            h+='</div>';}
            c.innerHTML=h;
        }

        function populateCalendar(){
            var grid=document.getElementById('calendarGrid');
            var days=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
            var h='';
            for(var i=0;i<7;i++){h+='<div class="calendar-header">'+days[i]+'</div>';}
            // February 2026 starts on Sunday (day 0)
            var daysInMonth=28;
            var startDay=0; // Sunday
            // Add empty cells for days before month starts (none needed for Feb 2026)
            for(var d=1;d<=daysInMonth;d++){
                var dateStr='2026-02-'+(d<10?'0':'')+d;
                var isToday=(d===11);
                var dayEvents=calendarEvents.filter(function(e){return e.date===dateStr});
                h+='<div class="calendar-day'+(isToday?' today':'')+'">';
                h+='<div class="calendar-date">'+d+'</div>';
                for(var e=0;e<dayEvents.length;e++){
                    h+='<div class="calendar-event '+dayEvents[e].type+'">'+dayEvents[e].title+'</div>';
                }
                h+='</div>';
            }
            grid.innerHTML=h;
        }

        function populateEventList(){
            var list=document.getElementById('eventList');
            var today=new Date('2026-02-11');
            var upcoming=calendarEvents.filter(function(e){return new Date(e.date)>=today}).sort(function(a,b){return new Date(a.date)-new Date(b.date)});
            var h='';
            if(upcoming.length===0){
                h='<div class="no-events">No upcoming events scheduled</div>';
            } else {
                for(var i=0;i<upcoming.length;i++){var e=upcoming[i];
                var d=new Date(e.date);
                var months=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
                var timeStr=e.time?'üïê '+e.time+' ¬∑ ':'';
                h+='<div class="event-item"><div class="event-date-box"><div class="event-month">'+months[d.getMonth()]+'</div><div class="event-day">'+d.getDate()+'</div></div><div class="event-details"><div class="event-title">'+e.title+'<span class="event-type calendar-event '+e.type+'">'+e.type.replace('-',' ')+'</span></div><div class="event-meta">'+timeStr+'üìç '+e.station+'</div></div></div>';}
            }
            list.innerHTML=h;
        }

        function populatePastEventList(){
            var list=document.getElementById('pastEventList');
            var today=new Date('2026-02-11');
            var past=calendarEvents.filter(function(e){return new Date(e.date)<today}).sort(function(a,b){return new Date(b.date)-new Date(a.date)});
            var h='';
            if(past.length===0){
                h='<div class="no-events">No past events with notes yet</div>';
            } else {
                for(var i=0;i<past.length;i++){var e=past[i];
                var d=new Date(e.date);
                var months=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
                var timeStr=e.time?'üïê '+e.time+' ¬∑ ':'';
                h+='<div class="event-item past"><div class="event-date-box"><div class="event-month">'+months[d.getMonth()]+'</div><div class="event-day">'+d.getDate()+'</div></div><div class="event-details"><div class="event-title">'+e.title+'<span class="event-type calendar-event '+e.type+'">'+e.type.replace('-',' ')+'</span></div><div class="event-meta">'+timeStr+'üìç '+e.station+'</div>';
                if(e.notes){h+='<div class="event-notes"><div class="event-notes-label">üìù Notes</div>'+e.notes+'</div>';}
                h+='</div></div>';}
            }
            list.innerHTML=h;
        }

        function populateRoundtableActions(){
            var container=document.getElementById('roundtableActions');
            var h='';
            var stations=['HMS2','HCL2'];
            for(var s=0;s<stations.length;s++){
                var station=stations[s];
                var stationActions=roundtableActions.filter(function(a){return a.station===station});
                if(stationActions.length>0){
                    var dateStr=stationActions[0].date;
                    h+='<div class="roundtable-section">';
                    h+='<div class="roundtable-header"><span class="roundtable-station">'+station+'</span><span class="roundtable-date">'+dateStr+' Roundtable</span></div>';
                    for(var i=0;i<stationActions.length;i++){var a=stationActions[i];
                    h+='<div class="action-item-row"><div class="action-checkbox '+(a.status==='done'?'done':'')+'"></div><span class="action-owner">'+a.owner+'</span><span class="action-text">'+a.action+'</span><span class="action-status '+a.status+'">'+a.status+'</span></div>';}
                    h+='</div>';
                }
            }
            container.innerHTML=h;
        }

        function createCharts(){
            var colors=['#00ff88','#00d4ff','#3742fa','#a855f7','#ff4757','#ffa502','#ff6b81','#2ed573','#1e90ff','#ff9ff3','#54a0ff','#ffd93d','#c8d6e5'];
            
            new Chart(document.getElementById('weeklyBarChart'),{
                type:'bar',
                data:{labels:['WK1','WK2','WK3','WK4','WK5','WK6'],datasets:[{label:'Kooner WOs',data:[58,140,140,159,153,148],backgroundColor:'rgba(0,255,136,0.7)',borderRadius:4}]},
                options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{color:'#8b8b9a'}}},scales:{y:{grid:{color:'rgba(255,255,255,0.05)'},ticks:{color:'#8b8b9a'}},x:{grid:{display:false},ticks:{color:'#8b8b9a'}}}}
            });

            var sortedStations=stationData.slice().sort(function(a,b){return b.adoption-a.adoption});
            new Chart(document.getElementById('stationBarChart'),{
                type:'bar',
                data:{labels:sortedStations.map(function(s){return s.station}),datasets:[{data:sortedStations.map(function(s){return s.adoption}),backgroundColor:sortedStations.map(function(s){return s.adoption>=85?'rgba(0,255,136,0.7)':'rgba(255,71,87,0.7)'}),borderRadius:4}]},
                options:{responsive:true,maintainAspectRatio:false,indexAxis:'y',plugins:{legend:{display:false}},scales:{x:{beginAtZero:true,max:100,grid:{color:'rgba(255,255,255,0.05)'},ticks:{color:'#8b8b9a',callback:function(v){return v+'%'}}},y:{grid:{display:false},ticks:{color:'#8b8b9a'}}}}
            });

            var weekLabels=['WK1','WK2','WK3','WK4','WK5','WK6'];
            var topStations=['HDT3','HLA2','HHO3','HTP2','HMK4','HCL2','HDY1','HAU1'];
            var datasets=topStations.map(function(st,i){
                var w=weeklyByStation[st];
                return{label:st,data:[w.WK1||0,w.WK2||0,w.WK3||0,w.WK4||0,w.WK5||0,w.WK6||0],backgroundColor:colors[i],borderRadius:2};
            });
            new Chart(document.getElementById('stationWeeklyChart'),{type:'bar',data:{labels:weekLabels,datasets:datasets},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{color:'#8b8b9a'},position:'right'}},scales:{y:{stacked:true,grid:{color:'rgba(255,255,255,0.05)'},ticks:{color:'#8b8b9a'}},x:{stacked:true,grid:{display:false},ticks:{color:'#8b8b9a'}}}}});

            new Chart(document.getElementById('stationRankChart'),{type:'bar',data:{labels:sortedStations.map(function(s){return s.station}),datasets:[{label:'Kooner',data:sortedStations.map(function(s){return s.kooner}),backgroundColor:'rgba(0,255,136,0.7)',borderRadius:2},{label:'Leaked',data:sortedStations.map(function(s){return s.leaked}),backgroundColor:'rgba(255,71,87,0.7)',borderRadius:2}]},options:{responsive:true,maintainAspectRatio:false,indexAxis:'y',plugins:{legend:{labels:{color:'#8b8b9a'}}},scales:{x:{stacked:true,grid:{color:'rgba(255,255,255,0.05)'},ticks:{color:'#8b8b9a'}},y:{stacked:true,grid:{display:false},ticks:{color:'#8b8b9a'}}}}});

            var leakStations=stationData.filter(function(s){return s.leaked>0}).sort(function(a,b){return b.leaked-a.leaked});
            new Chart(document.getElementById('leakageChart'),{type:'doughnut',data:{labels:leakStations.map(function(s){return s.station}),datasets:[{data:leakStations.map(function(s){return s.leaked}),backgroundColor:colors,borderWidth:0}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'right',labels:{color:'#8b8b9a',padding:8}}},cutout:'60%'}});

            new Chart(document.getElementById('sentimentChart'),{type:'bar',data:{labels:sentimentData.map(function(d){return d.dsp}),datasets:[{label:'Satisfaction',data:sentimentData.map(function(d){return d.satisfaction}),backgroundColor:'rgba(168,85,247,0.7)',borderRadius:4},{label:'Timeliness',data:sentimentData.map(function(d){return d.timeliness}),backgroundColor:'rgba(0,212,255,0.7)',borderRadius:4},{label:'Quality',data:sentimentData.map(function(d){return d.quality}),backgroundColor:'rgba(255,217,61,0.7)',borderRadius:4}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{color:'#8b8b9a'}}},scales:{y:{beginAtZero:true,max:5,grid:{color:'rgba(255,255,255,0.05)'},ticks:{color:'#8b8b9a'}},x:{grid:{display:false},ticks:{color:'#8b8b9a'}}}}});

            new Chart(document.getElementById('correlationChart'),{type:'scatter',data:{datasets:[{label:'DSPs',data:sentimentData.map(function(d){return{x:d.avgScore,y:d.adoption,label:d.dsp}}),backgroundColor:function(ctx){var v=ctx.raw;if(!v)return'#8b8b9a';if(v.y>=85)return'rgba(0,255,136,0.8)';if(v.y>=50)return'rgba(255,165,2,0.8)';return'rgba(255,71,87,0.8)'},pointRadius:12,pointHoverRadius:15}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:{callbacks:{label:function(ctx){var p=ctx.raw;return p.label+': '+p.x.toFixed(1)+' sent, '+p.y.toFixed(1)+'% adopt'}}}},scales:{y:{beginAtZero:true,max:100,title:{display:true,text:'Adoption %',color:'#8b8b9a'},grid:{color:'rgba(255,255,255,0.05)'},ticks:{color:'#8b8b9a',callback:function(v){return v+'%'}}},x:{beginAtZero:true,max:5,title:{display:true,text:'Sentiment',color:'#8b8b9a'},grid:{color:'rgba(255,255,255,0.05)'},ticks:{color:'#8b8b9a'}}}}});
        }

        document.addEventListener('DOMContentLoaded',function(){
            populateStationQuickTable();
            populateOpportunityTable();
            populateStationFullTable();
            populateStationWeeklyTable();
            populateDSPTable('all');
            populateActionCards();
            populateActionTable();
            populateFeedbackList();
            populateCalendar();
            populateEventList();
            populatePastEventList();
            populateRoundtableActions();
            createCharts();
        });
    </script>
</body>
</html>
