
how can I share a dashboard with a teammate to update weekly

3:14 PM
Are you asking about sharing a dashboard in a specific tool or platform? That'll help me give you the most relevant answer.

In the meantime, here are some general approaches that work well for collaborative weekly dashboards:

Google Sheets is often the easiest option ‚Äî you can share a link with edit access, and your teammate can update it directly each week. You can also protect certain tabs/ranges so only the data entry areas are editable.

Notion lets you share a page or database with specific teammates and assign ownership of updates. You could even set up a recurring reminder.

Excel via OneDrive/SharePoint supports co-authoring if you save the file to a shared location rather than emailing it back and forth.

General tips for a smooth weekly handoff:

Clearly mark which cells/fields need updating (color coding or comments help)
Add a "Last Updated" field so you both know it's current
Consider a simple checklist or instructions tab so the process is repeatable
Set a recurring calendar reminder for whoever's responsible each week
Let me know which platform you're using and I can walk you through the specifics!

Claude

3:16 PM
Got it ‚Äî you're looking to share a dashboard built in Claude with a teammate for weekly updates.

Claude conversations and artifacts aren't natively shareable for collaborative editing the way a Google Sheet or Notion page would be. Here are a few practical approaches:

Export and collaborate externally. If your dashboard is a spreadsheet or document, you can download the file Claude creates and upload it to Google Sheets, OneDrive, or Notion where your teammate can edit it weekly. This is usually the simplest path.

Share the artifact link. If you created a React or HTML artifact in Claude, you can share the link with your teammate so they can view it ‚Äî but they won't be able to edit it directly within Claude.

Rebuild it in a collaborative tool. If the dashboard needs true two-way collaboration, I can help you recreate it in a format designed for that ‚Äî like a Google Sheet template or a Notion database ‚Äî that you and your teammate can both update.

Which of these sounds closest to what you need? And what format is your current dashboard in ‚Äî a spreadsheet, a React artifact, something else?

I would just like to assign a member of my team to upload refreshed data each week for updates

3:25 PM
That makes sense. Here's a practical workflow for that:

Recommended setup:

I build the dashboard as an artifact (React or HTML) that reads from a CSV or data source your teammate uploads.
Each week, your teammate opens the Claude conversation (or a fresh one), uploads the refreshed data file, and asks Claude to regenerate the updated dashboard.
They download or share the updated output.
To make this seamless for your teammate:

Create a simple instruction doc (I can draft this for you) explaining exactly what file to upload and what to ask Claude
Standardize the data format ‚Äî same column names, same file type each week ‚Äî so the dashboard rebuilds cleanly every time
Have them use the same prompt each week, something like: "Here's this week's data. Please regenerate the dashboard using the same format as before."
Even better option: If you want the dashboard to persist and just get refreshed data, I can build it as a React artifact that uses persistent storage ‚Äî your teammate would upload new data into the artifact itself without needing to rebuild anything.

Want me to set up a dashboard with persistent storage so your teammate can just paste or upload new data each week? If so, tell me about the data and metrics you're tracking and I'll get it started.

Yes. Would my team member need Claude access?

3:35 PM
Yes, they would need a Claude account to access and interact with the artifact. Anyone you share the artifact link with needs to be logged into Claude to view and use it.

If your teammate already has access (or your org is on a Team or Enterprise plan), this is straightforward ‚Äî you share the artifact link, and they can open it and upload refreshed data each week.

If they don't have Claude access, a couple of alternatives:

You handle the upload yourself based on data they send you (email, Slack, shared drive)
Build the dashboard in a tool they already have access to ‚Äî I can create a Google Sheets or Excel version instead
Want to move forward with the persistent storage artifact approach? If so, tell me what data and metrics you're tracking and I'll build it out.

what is the best way to ensure auto-updates to the dashboard published through github?

3:37 PM
Great question ‚Äî if you publish the dashboard through GitHub (via GitHub Pages), you can set up auto-updates with a few different approaches depending on your team's technical comfort level.

Best approach: GitHub Actions + scheduled data refresh

The idea is to store your dashboard code and data file in a GitHub repo, then use GitHub Actions to automatically pull fresh data on a schedule and redeploy.

Here's how it works:

Host the dashboard on GitHub Pages ‚Äî I can build it as a standalone HTML file that reads from a JSON or CSV data file in the same repo.
Your teammate updates the data by pushing a new CSV/JSON file to the repo each week (they can even do this through GitHub's web interface ‚Äî no command line needed).
GitHub Actions detects the change and automatically rebuilds/redeploys the dashboard.
You can also set it up so the Action runs on a cron schedule (e.g., every Monday at 8am) if the data source is somewhere fetchable like a Google Sheet or API.

Simpler alternative: manual file swap

Your teammate just replaces the data file in the repo through GitHub's web UI. GitHub Pages auto-redeploys on any commit to the main branch, so the dashboard updates within minutes ‚Äî no Actions needed.

Want me to build this out? I'd need to know:

What metrics/data the dashboard tracks
What format the source data comes in (CSV, Excel, Google Sheet, etc.)
Who's the audience ‚Äî just your team, or external stakeholders too?
for the adoption dashboard, i want to ensure survey submissions are uploaded each week and the events calendar is updated with new event schedules and past event summaries/notes

3:39 PM

Searched memory











Brooke, I found the adoption dashboard we built ‚Äî the Kooner WK05 dashboard with the adoption tab showing station breakdowns, trend charts, and KPIs. Let me clarify what you're looking to set up for the GitHub-hosted version:

You want two recurring data inputs your teammate would manage weekly:

Survey submissions ‚Äî DSP feedback/satisfaction surveys uploaded with fresh responses each week
Events calendar ‚Äî updated with new upcoming event schedules and annotated with past event summaries/notes
To build this right for GitHub Pages auto-updates, I have a few questions:

This will help me design the right workflow ‚Äî whether that's a simple CSV file swap in GitHub's web interface, a Google Sheets integration that auto-pulls data, or something in between. The goal is to make it as low-friction as possible for whoever's handling the weekly updates.

Q: How does your teammate currently collect survey data?
A: Jotform

Q: For the events calendar, what kind of events are tracked?
A: Mix of all the above

Q: How technical is the teammate who'll be updating this?
A: Can follow step-by-step instructions

3:41 PM
Perfect ‚Äî Jotform makes this really clean. Here's the architecture I'd recommend for your GitHub Pages dashboard:

Survey Data (Jotform ‚Üí Dashboard): Jotform has a webhook and API integration, so there are two approaches depending on how automated you want it:

Option A (Fully automated): Use Jotform's webhook to push submissions to a Google Sheet, then the dashboard pulls from the published Google Sheet CSV URL. Zero manual work ‚Äî new submissions appear automatically.
Option B (Weekly manual upload): Your teammate exports the Jotform responses as CSV each week and uploads the file to the GitHub repo via the web interface. Simple, but requires a weekly touchpoint.
Events Calendar: Since this is a mix of DSP outreach, training sessions, and station visits, your teammate would update a structured JSON or CSV file in GitHub with new event schedules and add summary notes for completed events. I can build the dashboard UI to clearly distinguish upcoming vs. past events and display the notes.

The weekly workflow for your teammate would look like:

Log into GitHub (web browser)
Upload the refreshed survey export CSV (if not using auto-sync)
Edit the events file to add new events and annotate past ones
Commit ‚Äî GitHub Pages auto-redeploys within minutes
I can build a step-by-step guide with screenshots for them.

Once you confirm, I'll build out the dashboard with the data connection setup and create the teammate instruction guide.


<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Kooner Adoption Dashboard</title> <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Space+Grotesk:wgh

pasted

this is the most update to date dashboard:

3:43 PM
Got it ‚Äî I have the latest version of the Kooner Adoption Dashboard. Let me look at it and the relevant skills before building the GitHub-ready version with the Jotform auto-sync and updatable events calendar.

Before I start building, let me confirm the plan based on your earlier answers:

Survey data: Jotform ‚Üí Google Sheets auto-sync ‚Üí dashboard pulls from published Google Sheet CSV (fully automated, no manual upload needed)
Events calendar: Your teammate updates a simple JSON file in GitHub's web editor to add new events and paste in roundtable notes/summaries
Teammate skill level: Step-by-step instructions, no command line required
A couple of quick clarifications before I build:

This will determine whether I build separate data files for everything or just the two sections you mentioned.

Q: For the Jotform ‚Üí Google Sheets connection, do you already have your Jotform responses syncing to a Google Sheet?
A: Yes, already set up

Q: Should the rest of the dashboard data (station adoption, weekly WO counts, DSP data) also be updatable by your teammate, or just the survey and calendar?
A: Just survey + calendar for now

3:44 PM
Perfect ‚Äî let me read the frontend design skill and then build this out. The approach will be:

Dashboard HTML ‚Äî same design as your current one, but the survey and calendar sections pull from external data files
survey-data.csv ‚Äî your teammate points this to the Google Sheets published CSV URL (or replaces the file)
events-data.json ‚Äî simple JSON file your teammate edits in GitHub to add/update events
Instruction guide ‚Äî step-by-step for your teammate

Read the frontend design skill
Now let me look at the current dashboard structure more carefully to understand the data format, then build the GitHub-ready version.


Ran 2 commands
Now let me build the complete GitHub-ready dashboard. I'll create three files: the main dashboard HTML (with Google Sheets integration for survey data), the events JSON data file your teammate will edit, and the instruction guide.


Creating the events data JSON file that the teammate will edit weekly in GitHub
Now let me build the main dashboard HTML ‚Äî this is the big one. I'll keep your exact design but modify the survey/sentiment and calendar sections to pull from external data sources.


Creating the main GitHub-ready dashboard HTML with Google Sheets integration for survey data and external JSON for events
Now let me create the teammate instruction guide:


Read the docx skill for creating the instruction guide
I'll create the instruction guide as a clean markdown file that can be shared directly:


Creating the teammate instruction guide as a markdown file
Now let me copy everything to outputs and present the files:


Ran a command, read a file
Here's what I built ‚Äî three files ready for your GitHub repo:

index.html ‚Äî The full dashboard, identical to your current one but with two key changes: the Sentiment tab now pulls survey data live from your Jotform-synced Google Sheet (via PapaParse CSV parsing), and the Calendar/Actions tabs pull from the external events-data.json file. If the Google Sheet isn't connected yet, it falls back to the existing hardcoded data so nothing breaks.

events-data.json ‚Äî The data file your teammate will edit in GitHub's web interface. Contains all your current roundtable events, notes, and action items. Adding a new event or updating notes is just editing this file and committing.

WEEKLY-UPDATE-GUIDE.md ‚Äî Step-by-step instructions for your teammate covering GitHub setup, Google Sheets connection, and how to update events weekly. Written for someone who can follow instructions but isn't deeply technical.

The one thing you'll need to do before handing off is replace YOUR_GOOGLE_SHEETS_PUBLISHED_CSV_URL_HERE in the index.html CONFIG section with your actual published Google Sheet URL, and verify the column names match your Jotform fields.

Index
Code ¬∑ HTML 
Events data
Code ¬∑ JSON 
Weekly update guide
Document ¬∑ MD 
index.html - failed to load events

3:57 PM
That's expected ‚Äî when viewing locally or in Claude's preview, the fetch() call to events-data.json fails because there's no server to serve the file. It'll work once deployed on GitHub Pages where both files live in the same directory.

But let me fix this so it works everywhere, including locally and in Claude's preview, by embedding the events data as a fallback directly in the HTML ‚Äî same pattern I used for the survey data.


Viewed 2 files, ran a command
Now I'll replace the loadEventsData function with one that has a built-in fallback, and add the fallback data:


Edited a file, read a file
Fixed ‚Äî the dashboard now embeds all event data as a fallback, so it works everywhere: Claude preview, local file, and GitHub Pages. When deployed on GitHub Pages with events-data.json in the same folder, it'll pull from the JSON file (so your teammate's edits take effect). When the fetch fails (like in preview), it seamlessly uses the embedded data instead. Calendar, past event notes, and roundtable action items should all render now.

Index
Code ¬∑ HTML 
the google sheet is in jotform, how do i connect that to my existing google drive

4:17 PM

Searched the web

Here's how to connect it ‚Äî it's built right into Jotform, no third-party tools needed:

In your Jotform Form Builder, go to Settings (orange navigation bar at the top), then click the Integrations tab on the left panel. Search for Google Sheets and click on it. 
Jotform

From there:

Click Authenticate and sign into your Google account (the one tied to your Google Drive)
You'll get two options: Create a New Spreadsheet or Use Existing Spreadsheet. If you choose "Use Existing Spreadsheet," it lets you pick a spreadsheet already in your Drive but creates a new worksheet tab within it to store form data. 
Jotform
 Either option works ‚Äî the new spreadsheet will automatically appear in your Google Drive.
Check that the field mappings look correct (your survey questions mapped to spreadsheet columns)
Click Save
After saving, every time someone fills out your form, their responses are added to the connected spreadsheet right away. 
Jotform
 Jotform will also ask if you want to push your existing historical submissions to the sheet ‚Äî say yes so you have all your data from the start.

Once the sheet is in your Google Drive, the last step for the dashboard connection is to publish it as CSV: go to File ‚Üí Share ‚Üí Publish to web, select the sheet tab, choose CSV, and copy that URL into the dashboard's CONFIG section.

One heads-up: renaming column headings in Google Sheets may break the integration, so leave the auto-generated column names as-is. 
Jotform
 If the column names from Jotform don't match what's in the dashboard CONFIG, just update the SURVEY_COLUMNS mapping in index.html to match your actual headers.

1771280350426_image.png
4:19 PM
That's the Jotform account settings page ‚Äî the Google Sheets integration is set up at the form level, not the account level. Here's where to go instead:

Go back to My Forms (top left or Jotform logo)
Open your DSP survey form specifically
Once inside the Form Builder, look for Settings in the top toolbar (or the gear icon)
Then click Integrations from within that form's settings
Search for Google Sheets there
Alternatively, if you're in the form builder view, you may see an Integrations button directly in the top toolbar/navigation bar ‚Äî it depends on which Jotform builder view you're using (classic vs. new).

Want to share a screenshot of what your form builder looks like once you open the survey form? I can point you to the exact spot.

here is the link:
https://docs.google.com/spreadsheets/d/e/2PACX-1vQXajk2Gv76ZmqD7YW8QXe6Rs7AOsfbJi3ueRJ4X_F9EX_63eWozXWFfQExGIcqYIjpwPT-L_nQudS6/pub?gid=2094613316&single=true&output=csv

4:25 PM
Perfect ‚Äî that's exactly what the dashboard needs. Let me plug that into your index.html now.


Replace the placeholder Google Sheets URL with the actual published CSV URL
Now I need to check what your actual column headers are so the dashboard maps them correctly. Let me fetch the CSV to see:


Failed to fetch: https://docs.google.com/spreadsheets/d/e/2PACX-1vQXajk2Gv76ZmqD7YW8QXe6Rs7AOsfbJi3ueRJ4X_F9EX_63eWozXWFfQExGIcqYIjpwPT-L_nQudS6/pub?gid=2094613316&single=true&output=csv
Can't fetch it directly from here due to Google's restrictions, but PapaParse in the browser will have no problem loading it. I just need to know your column headers so the mapping is correct.

Can you open that CSV link in your browser and tell me the exact column names in the first row? I'm looking for which columns contain the date, DSP code, station, satisfaction/timeliness/quality ratings, issues, and feedback text.

Or if it's easier, take a screenshot of the first few rows of the Google Sheet and I'll match them up.

Submission Date    Full Name    Station/Site Code    DSP Shortcode    Preferred Contact Information    Overall satisfaction with Kooner's services this week:    Timeliness of service:    Quality of repairs:    Did you experience any unresolved issues this week? If so, please briefly describe the issue(s)    Is there anything else our team can do to better support you?    Please share any additional fleet or service-related feedback from this week.    Would you like someone from the Kooner Ops team to follow up with you? If yes, please include your preferred method of contact.    Submission ID

4:27 PM
Got it ‚Äî let me update the column mapping to match your actual headers.


Update the SURVEY_COLUMNS mapping to match actual Jotform Google Sheet column headers
Now I need to update the data parsing function to handle the additional fields and also account for the fact that your ratings might be text like "1 - Very Dissatisfied" or just numbers. Let me update the parsing logic:


Update survey data parsing to handle additional fields and possible text-based ratings
Now let me update the feedback card rendering to show the contact name and follow-up request:


Edited a file, read a file
Updated. Here's what changed:

Column mapping now matches your exact Jotform headers ‚Äî DSP Shortcode, Station/Site Code, the full question text for each rating, issues, and feedback fields.

Rating parser handles both numeric values ("3") and text-based formats ("3 - Neutral") in case Jotform outputs either style.

Additional fields now rendered: the respondent's name shows next to the DSP/station tag, the "additional feedback" field is combined with the main suggestion, and follow-up requests display as a highlighted purple callout on each feedback card.

The Sentiment tab will pull live from your Google Sheet when deployed. In Claude's preview it'll fall back to the hardcoded data since it can't reach Google's domain from here ‚Äî but once it's on GitHub Pages, you'll see your actual Jotform responses.

Index
Code ¬∑ HTML 
what do i do in github

4:31 PM
Here's the step-by-step:

1. Create the repository

Go to github.com/new and create a new repo named kooner-adoption-dashboard. Set it to Public and click Create repository.

2. Upload your files

On the empty repo page, click "uploading an existing file" (or the Add file ‚Üí Upload files button). Drag in both files from your downloads:

index.html
events-data.json
Click Commit changes.

3. Turn on GitHub Pages

In your repo, go to Settings (top tab bar) ‚Üí Pages (left sidebar under "Code and automation"). Under "Source," select Deploy from a branch, choose main and / (root), then click Save.

4. Wait 2-3 minutes

Your dashboard will be live at: https://[your-username].github.io/kooner-adoption-dashboard/

That's it ‚Äî the survey data will auto-pull from your Jotform Google Sheet, and your teammate can update events by editing events-data.json directly in GitHub's web editor. Share that URL with anyone who needs to view the dashboard.

Want me to walk you through setting up your teammate's GitHub access too?

i already have a repository for this, do i need to create a new one?

4:32 PM
No ‚Äî just upload the updated files to your existing repo. They'll replace what's already there.

In your existing repository:

Click Add file ‚Üí Upload files
Drag in the new index.html and events-data.json
It'll prompt you that index.html already exists ‚Äî that's fine, it'll overwrite it
Click Commit changes
If you already have GitHub Pages enabled on this repo, the dashboard will auto-redeploy within a couple minutes with the live Google Sheets connection.

What's the repo name? I can also check if there's anything in the existing structure I should account for (like if files are in a subfolder vs. root).

where is the events-data.json file

4:33 PM
It's one of the three files I provided earlier in this conversation ‚Äî scroll up to where I shared the files, or you can download it again here:


Presented 3 files
All three files to upload to your repo:

events-data.json ‚Äî the calendar/events data file your teammate will edit weekly
index.html ‚Äî the updated dashboard with live Google Sheets connection
WEEKLY-UPDATE-GUIDE.md ‚Äî the step-by-step instructions for your teammate
Make sure events-data.json goes in the same folder (root) as index.html in your repo.

Events data
Code ¬∑ JSON 
Index
Code ¬∑ HTML 
Weekly update guide
Document ¬∑ MD 


where is the events

Claude is AI and can make mistakes. Please double-check responses.
Index ¬∑ HTML
Copy

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kooner Adoption Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        :root{--bg-dark:#0a0a0f;--bg-card:#12121a;--bg-card-hover:#1a1a25;--accent-green:#00ff88;--accent-red:#ff4757;--accent-orange:#ffa502;--accent-blue:#3742fa;--accent-purple:#a855f7;--accent-cyan:#00d4ff;--accent-yellow:#ffd93d;--text-primary:#ffffff;--text-secondary:#8b8b9a;--text-muted:#4a4a5a;--border-color:#2a2a3a}
        *{margin:0;padding:0;box-sizing:border-box}body{font-family:'Space Grotesk',sans-serif;background:var(--bg-dark);color:var(--text-primary);min-height:100vh}
        .bg-grid{position:fixed;top:0;left:0;width:100%;height:100%;background-image:linear-gradient(rgba(55,66,250,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(55,66,250,0.03) 1px,transparent 1px);background-size:50px 50px;pointer-events:none;z-index:0}
        .container{position:relative;z-index:1;max-width:1600px;margin:0 auto;padding:24px}
        .header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:32px;padding-bottom:24px;border-bottom:1px solid var(--border-color)}
        .header-left h1{font-size:2.5rem;font-weight:700;letter-spacing:-0.02em;margin-bottom:8px;background:linear-gradient(135deg,#fff 0%,#8b8b9a 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
        .header-left .subtitle{color:var(--text-secondary);font-size:1rem;display:flex;align-items:center;gap:12px}
        .target-badge{background:linear-gradient(135deg,var(--accent-green),#00cc6a);color:#000;padding:4px 12px;border-radius:20px;font-weight:600;font-size:0.85rem}
        .header-right{text-align:right}.last-updated{color:var(--text-muted);font-size:0.85rem;font-family:'JetBrains Mono',monospace}.data-period{color:var(--text-secondary);font-size:0.9rem;margin-top:4px}
        .data-source-info{font-size:0.75rem;color:var(--text-muted);margin-top:4px;font-style:italic}
        .nav-tabs{display:flex;gap:8px;margin-bottom:24px;background:var(--bg-card);padding:8px;border-radius:12px;width:fit-content;flex-wrap:wrap}
        .nav-tab{padding:10px 20px;border-radius:8px;font-size:0.9rem;font-weight:500;cursor:pointer;transition:all 0.2s ease;background:transparent;border:none;color:var(--text-secondary)}
        .nav-tab:hover{background:var(--bg-card-hover);color:var(--text-primary)}.nav-tab.active{background:var(--accent-blue);color:white}
        .tab-content{display:none}.tab-content.active{display:block}
        .kpi-row{display:grid;grid-template-columns:repeat(5,1fr);gap:16px;margin-bottom:32px}
        .kpi-card{background:var(--bg-card);border:1px solid var(--border-color);border-radius:16px;padding:24px;position:relative;overflow:hidden}
        .kpi-card::before{content:'';position:absolute;top:0;left:0;width:100%;height:3px;background:linear-gradient(90deg,var(--accent-blue),var(--accent-purple))}
        .kpi-card.success::before{background:linear-gradient(90deg,var(--accent-green),#00cc6a)}
        .kpi-card.warning::before{background:linear-gradient(90deg,var(--accent-orange),#ff6b00)}
        .kpi-card.danger::before{background:linear-gradient(90deg,var(--accent-red),#ff2f43)}
        .kpi-label{font-size:0.85rem;color:var(--text-secondary);text-transform:uppercase;letter-spacing:0.05em;margin-bottom:8px}
        .kpi-value{font-size:2.2rem;font-weight:700;font-family:'JetBrains Mono',monospace;line-height:1}
        .kpi-value.green{color:var(--accent-green)}.kpi-value.red{color:var(--accent-red)}.kpi-value.orange{color:var(--accent-orange)}.kpi-value.yellow{color:var(--accent-yellow)}
        .kpi-subtext{font-size:0.8rem;color:var(--text-muted);margin-top:8px}
        .main-grid{display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:32px}
        .card{background:var(--bg-card);border:1px solid var(--border-color);border-radius:16px;padding:24px}
        .card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
        .card-title{font-size:1.1rem;font-weight:600}
        .card-badge{font-size:0.75rem;padding:4px 10px;border-radius:12px;font-family:'JetBrains Mono',monospace}
        .badge-stations{background:rgba(55,66,250,0.2);color:var(--accent-blue)}
        .badge-dsps{background:rgba(168,85,247,0.2);color:var(--accent-purple)}
        .badge-trends{background:rgba(0,212,255,0.2);color:var(--accent-cyan)}
        .badge-insights{background:rgba(0,255,136,0.2);color:var(--accent-green)}
        .badge-sentiment{background:rgba(255,217,61,0.2);color:var(--accent-yellow)}
        .badge-calendar{background:rgba(255,71,87,0.2);color:var(--accent-red)}
        .badge-live{background:rgba(0,255,136,0.2);color:var(--accent-green);animation:pulse 2s infinite}
        @keyframes pulse{0%,100%{opacity:1}50%{opacity:0.6}}
        .data-table{width:100%;border-collapse:collapse}
        .data-table th{text-align:left;padding:12px 8px;font-size:0.75rem;text-transform:uppercase;letter-spacing:0.05em;color:var(--text-muted);border-bottom:1px solid var(--border-color);background:var(--bg-card)}
        .data-table td{padding:14px 8px;font-size:0.9rem;border-bottom:1px solid var(--border-color)}
        .data-table tr:hover td{background:rgba(55,66,250,0.05)}
        .station-name{font-weight:600;font-family:'JetBrains Mono',monospace}
        .status-pill{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;border-radius:20px;font-size:0.75rem;font-weight:500}
        .status-pill.on-target{background:rgba(0,255,136,0.15);color:var(--accent-green)}
        .status-pill.below-target{background:rgba(255,71,87,0.15);color:var(--accent-red)}
        .status-dot{width:6px;height:6px;border-radius:50%;background:currentColor}
        .priority-pill{display:inline-block;padding:4px 10px;border-radius:12px;font-size:0.7rem;font-weight:600;text-transform:uppercase}
        .priority-critical{background:rgba(255,71,87,0.2);color:var(--accent-red)}
        .priority-high{background:rgba(255,165,2,0.2);color:var(--accent-orange)}
        .priority-medium{background:rgba(55,66,250,0.2);color:var(--accent-blue)}
        .priority-low{background:rgba(139,139,154,0.2);color:var(--text-secondary)}
        .priority-on-target{background:rgba(0,255,136,0.2);color:var(--accent-green)}
        .full-width{grid-column:1/-1}
        .action-list{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
        .action-card{background:var(--bg-card-hover);border:1px solid var(--border-color);border-radius:12px;padding:20px}
        .action-card.critical{border-left:3px solid var(--accent-red)}.action-card.high{border-left:3px solid var(--accent-orange)}.action-card.medium{border-left:3px solid var(--accent-blue)}
        .action-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px}
        .action-dsp{font-size:1.3rem;font-weight:700;font-family:'JetBrains Mono',monospace}
        .action-station{background:var(--bg-dark);padding:4px 10px;border-radius:8px;font-size:0.8rem;font-family:'JetBrains Mono',monospace;color:var(--text-secondary)}
        .action-stats{display:flex;gap:16px;margin-bottom:12px;flex-wrap:wrap}
        .action-stat{display:flex;flex-direction:column}
        .action-stat-label{font-size:0.7rem;color:var(--text-muted);text-transform:uppercase}
        .action-stat-value{font-size:1rem;font-weight:600;font-family:'JetBrains Mono',monospace}
        .action-stat-value.red{color:var(--accent-red)}.action-stat-value.orange{color:var(--accent-orange)}.action-stat-value.green{color:var(--accent-green)}.action-stat-value.yellow{color:var(--accent-yellow)}
        .action-feedback{font-size:0.8rem;color:var(--text-secondary);padding:10px;background:var(--bg-dark);border-radius:8px;margin-top:10px;font-style:italic;border-left:2px solid var(--accent-yellow)}
        .chart-container{position:relative;height:300px;width:100%}.chart-container.tall{height:400px}
        .filter-row{display:flex;gap:8px;margin-bottom:16px;flex-wrap:wrap}
        .filter-btn{padding:6px 14px;border-radius:20px;font-size:0.8rem;font-weight:500;cursor:pointer;background:var(--bg-card-hover);border:1px solid var(--border-color);color:var(--text-secondary)}
        .filter-btn:hover,.filter-btn.active{background:var(--accent-blue);border-color:var(--accent-blue);color:white}
        .table-scroll{max-height:400px;overflow-y:auto}
        .insights-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px}
        .insight-card{background:var(--bg-card-hover);border:1px solid var(--border-color);border-radius:12px;padding:20px;border-left:4px solid var(--accent-blue)}
        .insight-card.positive{border-left-color:var(--accent-green)}.insight-card.negative{border-left-color:var(--accent-red)}
        .insight-card.warning{border-left-color:var(--accent-orange)}.insight-card.info{border-left-color:var(--accent-cyan)}
        .insight-icon{font-size:1.5rem;margin-bottom:10px}.insight-title{font-size:1rem;font-weight:600;margin-bottom:8px}
        .insight-text{font-size:0.9rem;color:var(--text-secondary);line-height:1.5}
        .insight-metric{display:inline-block;font-family:'JetBrains Mono',monospace;font-weight:600;padding:2px 6px;border-radius:4px;background:rgba(255,255,255,0.1)}
        .executive-summary{background:linear-gradient(135deg,rgba(55,66,250,0.1),rgba(168,85,247,0.1));border:1px solid var(--accent-blue);border-radius:12px;padding:24px;margin-bottom:24px}
        .executive-summary h3{font-size:1.2rem;margin-bottom:16px;color:var(--accent-cyan)}
        .executive-summary ul{list-style:none;padding:0}
        .executive-summary li{padding:8px 0;padding-left:24px;position:relative;color:var(--text-secondary);font-size:0.95rem;line-height:1.5}
        .executive-summary li::before{content:'‚Üí';position:absolute;left:0;color:var(--accent-blue)}
        .sentiment-score{display:inline-flex;align-items:center;justify-content:center;width:32px;height:32px;border-radius:8px;font-family:'JetBrains Mono',monospace;font-weight:700;font-size:0.9rem}
        .sentiment-score.score-5{background:rgba(0,255,136,0.2);color:var(--accent-green)}
        .sentiment-score.score-4{background:rgba(0,212,255,0.2);color:var(--accent-cyan)}
        .sentiment-score.score-3{background:rgba(255,217,61,0.2);color:var(--accent-yellow)}
        .sentiment-score.score-2{background:rgba(255,165,2,0.2);color:var(--accent-orange)}
        .sentiment-score.score-1{background:rgba(255,71,87,0.2);color:var(--accent-red)}
        .feedback-card{background:var(--bg-card-hover);border:1px solid var(--border-color);border-radius:12px;padding:20px;margin-bottom:16px}
        .feedback-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px;padding-bottom:12px;border-bottom:1px solid var(--border-color);flex-wrap:wrap;gap:10px}
        .feedback-meta{display:flex;gap:16px;align-items:center;flex-wrap:wrap}.feedback-date{font-size:0.8rem;color:var(--text-muted)}
        .feedback-scores{display:flex;gap:8px}
        .score-mini{display:flex;flex-direction:column;align-items:center;gap:2px}
        .score-mini-label{font-size:0.6rem;color:var(--text-muted);text-transform:uppercase}
        .score-mini-value{font-family:'JetBrains Mono',monospace;font-weight:600;font-size:0.9rem}
        .feedback-text{font-size:0.9rem;color:var(--text-secondary);line-height:1.6;font-style:italic}
        .feedback-text.issue{border-left:3px solid var(--accent-red);padding-left:12px;margin-bottom:12px}
        .feedback-text.suggestion{border-left:3px solid var(--accent-cyan);padding-left:12px}
        .calendar-nav{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
        .calendar-nav-btn{background:var(--bg-card-hover);border:1px solid var(--border-color);color:var(--text-primary);padding:8px 16px;border-radius:8px;cursor:pointer;font-size:0.9rem;transition:all 0.2s}
        .calendar-nav-btn:hover{background:var(--accent-blue);border-color:var(--accent-blue)}
        .calendar-month-title{font-size:1.3rem;font-weight:600;font-family:'JetBrains Mono',monospace}
        .calendar-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;margin-bottom:24px}
        .calendar-header{text-align:center;padding:10px;font-size:0.75rem;color:var(--text-muted);text-transform:uppercase;font-weight:600}
        .calendar-day{background:var(--bg-card-hover);border:1px solid var(--border-color);border-radius:8px;min-height:100px;padding:8px}
        .calendar-day.other-month{opacity:0.3}
        .calendar-day.today{border-color:var(--accent-blue);background:rgba(55,66,250,0.1)}
        .calendar-date{font-size:0.85rem;font-weight:600;margin-bottom:6px;font-family:'JetBrains Mono',monospace}
        .calendar-event{font-size:0.7rem;padding:4px 6px;border-radius:4px;margin-bottom:4px;cursor:pointer;transition:transform 0.1s}
        .calendar-event:hover{transform:scale(1.02);opacity:0.9}
        .calendar-event.roundtable{background:rgba(168,85,247,0.3);color:var(--accent-purple);border-left:2px solid var(--accent-purple)}
        .calendar-event.site-visit{background:rgba(0,255,136,0.2);color:var(--accent-green);border-left:2px solid var(--accent-green)}
        .calendar-event.training{background:rgba(0,212,255,0.2);color:var(--accent-cyan);border-left:2px solid var(--accent-cyan)}
        .calendar-event.deadline{background:rgba(255,71,87,0.2);color:var(--accent-red);border-left:2px solid var(--accent-red)}
        .calendar-event.review{background:rgba(255,165,2,0.2);color:var(--accent-orange);border-left:2px solid var(--accent-orange)}
        .calendar-event.newsletter{background:rgba(0,200,150,0.2);color:#00c896;border-left:2px solid #00c896}
        .calendar-event.past{opacity:0.7}
        .modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:1000;display:none;justify-content:center;align-items:center;padding:20px}
        .modal-overlay.active{display:flex}
        .modal{background:var(--bg-card);border:1px solid var(--border-color);border-radius:16px;max-width:700px;width:100%;max-height:80vh;overflow-y:auto;position:relative}
        .modal-header{display:flex;justify-content:space-between;align-items:flex-start;padding:24px;border-bottom:1px solid var(--border-color)}
        .modal-title{font-size:1.3rem;font-weight:700}
        .modal-subtitle{font-size:0.9rem;color:var(--text-secondary);margin-top:4px}
        .modal-close{background:none;border:none;color:var(--text-muted);font-size:1.5rem;cursor:pointer;padding:4px 8px;border-radius:4px}
        .modal-close:hover{background:var(--bg-card-hover);color:var(--text-primary)}
        .modal-body{padding:24px}
        .modal-section{margin-bottom:20px}
        .modal-section-title{font-size:0.8rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.05em;margin-bottom:10px;font-weight:600}
        .modal-notes{background:var(--bg-dark);border-radius:8px;padding:16px;font-size:0.9rem;color:var(--text-secondary);line-height:1.7}
        .modal-actions{display:flex;flex-direction:column;gap:8px}
        .modal-action-item{display:flex;gap:12px;padding:10px;background:var(--bg-card-hover);border-radius:8px;align-items:flex-start}
        .modal-action-owner{font-size:0.75rem;color:var(--accent-purple);font-weight:600;text-transform:uppercase;min-width:80px}
        .modal-action-text{font-size:0.85rem;color:var(--text-secondary);flex:1}
        .event-list{margin-top:10px}
        .event-item{display:flex;gap:16px;padding:16px;background:var(--bg-card-hover);border:1px solid var(--border-color);border-radius:12px;margin-bottom:12px;align-items:flex-start}
        .event-item.past{border-left:3px solid var(--text-muted)}
        .event-date-box{background:var(--bg-dark);border-radius:8px;padding:12px;text-align:center;min-width:70px}
        .event-month{font-size:0.7rem;color:var(--accent-cyan);text-transform:uppercase;font-weight:600}
        .event-day{font-size:1.5rem;font-weight:700;font-family:'JetBrains Mono',monospace}
        .event-details{flex:1}
        .event-title{font-size:1rem;font-weight:600;margin-bottom:4px}
        .event-meta{font-size:0.85rem;color:var(--text-secondary)}
        .event-notes{margin-top:10px;padding:12px;background:var(--bg-dark);border-radius:8px;font-size:0.85rem;color:var(--text-secondary);line-height:1.6;border-left:3px solid var(--accent-purple)}
        .event-notes-label{font-size:0.7rem;color:var(--text-muted);text-transform:uppercase;margin-bottom:6px;font-weight:600}
        .event-type{display:inline-block;padding:2px 8px;border-radius:10px;font-size:0.7rem;font-weight:600;margin-left:8px}
        .no-events{text-align:center;padding:40px;color:var(--text-muted);font-style:italic}
        .legend{display:flex;gap:16px;flex-wrap:wrap;margin-bottom:20px}
        .legend-item{display:flex;align-items:center;gap:6px;font-size:0.8rem;color:var(--text-secondary)}
        .legend-dot{width:12px;height:12px;border-radius:3px}
        .roundtable-section{margin-bottom:24px}
        .roundtable-header{display:flex;align-items:center;gap:12px;margin-bottom:16px;padding-bottom:12px;border-bottom:1px solid var(--border-color)}
        .roundtable-station{font-size:1.1rem;font-weight:700;font-family:'JetBrains Mono',monospace}
        .roundtable-date{font-size:0.85rem;color:var(--text-muted)}
        .action-item-row{display:flex;gap:12px;padding:12px;background:var(--bg-card-hover);border-radius:8px;margin-bottom:8px;align-items:flex-start}
        .action-item-row:hover{background:rgba(55,66,250,0.1)}
        .action-checkbox{width:20px;height:20px;border:2px solid var(--border-color);border-radius:4px;flex-shrink:0;margin-top:2px;cursor:pointer}
        .action-checkbox.done{background:var(--accent-green);border-color:var(--accent-green)}
        .action-owner{font-size:0.75rem;color:var(--accent-purple);font-weight:600;text-transform:uppercase;min-width:80px;flex-shrink:0}
        .action-text{font-size:0.9rem;color:var(--text-secondary);flex:1}
        .action-status{font-size:0.7rem;padding:3px 8px;border-radius:10px;font-weight:600}
        .action-status.pending{background:rgba(255,165,2,0.2);color:var(--accent-orange)}
        .action-status.done{background:rgba(0,255,136,0.2);color:var(--accent-green)}
        .loading-indicator{display:flex;align-items:center;justify-content:center;padding:40px;color:var(--text-muted);gap:12px}
        .loading-spinner{width:20px;height:20px;border:2px solid var(--border-color);border-top:2px solid var(--accent-blue);border-radius:50%;animation:spin 1s linear infinite}
        @keyframes spin{to{transform:rotate(360deg)}}
        .data-error{background:rgba(255,71,87,0.1);border:1px solid rgba(255,71,87,0.3);border-radius:12px;padding:20px;text-align:center;color:var(--accent-red)}
        .data-error p{margin-top:8px;color:var(--text-secondary);font-size:0.85rem}
        @media(max-width:1200px){.kpi-row{grid-template-columns:repeat(3,1fr)}.action-list{grid-template-columns:repeat(2,1fr)}.insights-grid{grid-template-columns:1fr}}
        @media(max-width:900px){.main-grid{grid-template-columns:1fr}.kpi-row{grid-template-columns:repeat(2,1fr)}.action-list{grid-template-columns:1fr}}
        @media(max-width:600px){.header{flex-direction:column;gap:16px}.kpi-row{grid-template-columns:1fr}.nav-tabs{flex-wrap:wrap}.calendar-day{min-height:60px}}
    </style>
</head>
<body>
    <div class="bg-grid"></div>
    <div class="container">
        <header class="header">
            <div class="header-left">
                <h1>Kooner Adoption Dashboard</h1>
                <div class="subtitle"><span>Vendor Adoption Tracking</span><span class="target-badge">TARGET: 85%</span></div>
            </div>
            <div class="header-right">
                <div class="last-updated" id="lastUpdated">Last Updated: Loading...</div>
                <div class="data-period">Data Period: WK01 - WK06 (Dec 28 - Feb 7)</div>
                <div class="data-source-info">Survey: Live from Google Sheets ¬∑ Events: events-data.json</div>
            </div>
        </header>
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('overview')">üìä Overview</button>
            <button class="nav-tab" onclick="showTab('trends')">üìà Week-over-Week</button>
            <button class="nav-tab" onclick="showTab('stations')">üè¢ Stations</button>
            <button class="nav-tab" onclick="showTab('dsps')">üöõ DSPs</button>
            <button class="nav-tab" onclick="showTab('sentiment')">üí¨ DSP Sentiment</button>
            <button class="nav-tab" onclick="showTab('actions')">üéØ Actions</button>
            <button class="nav-tab" onclick="showTab('calendar')">üìÖ Calendar</button>
        </div>

        <!-- ===== OVERVIEW TAB ===== -->
        <div id="overview" class="tab-content active">
            <div class="kpi-row">
                <div class="kpi-card"><div class="kpi-label">Total Kooner WOs</div><div class="kpi-value green">811</div><div class="kpi-subtext">Completed by Kooner</div></div>
                <div class="kpi-card warning"><div class="kpi-label">Total Leaked WOs</div><div class="kpi-value orange">679</div><div class="kpi-subtext">Sent to other vendors</div></div>
                <div class="kpi-card danger"><div class="kpi-label">Current Adoption</div><div class="kpi-value red">54.4%</div><div class="kpi-subtext">30.6% gap to target</div></div>
                <div class="kpi-card success"><div class="kpi-label">On Target Stations</div><div class="kpi-value green">2</div><div class="kpi-subtext">of 12 stations ‚â•85%</div></div>
                <div class="kpi-card"><div class="kpi-label">Total WOs</div><div class="kpi-value">1,490</div><div class="kpi-subtext">Across 12 stations</div></div>
            </div>
            <div class="main-grid">
                <div class="card"><div class="card-header"><div class="card-title">Weekly Kooner Volume</div><span class="card-badge badge-trends">WK01-WK06</span></div><div class="chart-container"><canvas id="weeklyBarChart"></canvas></div></div>
                <div class="card"><div class="card-header"><div class="card-title">Station Adoption Distribution</div></div><div class="chart-container"><canvas id="stationBarChart"></canvas></div></div>
                <div class="card"><div class="card-header"><div class="card-title">Station Status</div><span class="card-badge badge-stations">12 STATIONS</span></div><div class="table-scroll" style="max-height:300px"><table class="data-table"><thead><tr><th>Station</th><th>Adoption</th><th>Kooner</th><th>Leaked</th><th>Status</th></tr></thead><tbody id="stationQuickTable"></tbody></table></div></div>
                <div class="card"><div class="card-header"><div class="card-title">Top Opportunities</div><span class="card-badge badge-dsps">BY LEAKED WOs</span></div><div class="table-scroll" style="max-height:300px"><table class="data-table"><thead><tr><th>Station</th><th>Leaked</th><th>Adoption</th><th>Potential</th></tr></thead><tbody id="opportunityTable"></tbody></table></div></div>
            </div>
        </div>

        <!-- ===== TRENDS TAB ===== -->
        <div id="trends" class="tab-content">
            <div class="main-grid">
                <div class="card full-width">
                    <div class="card-header"><div class="card-title">üìã WBR Executive Summary</div><span class="card-badge badge-insights">WK06 DATA</span></div>
                    <div class="executive-summary">
                        <h3>üéØ Key Takeaways</h3>
                        <ul>
                            <li><strong>Overall adoption at 54.4%</strong> ‚Äî 30.6% below the 85% target. WK06 shows significant improvement from prior weeks.</li>
                            <li><strong>2 stations meeting target:</strong> HSL1 (93.8%), HCT2 (85.7%)</li>
                            <li><strong>HLA2 remains the largest opportunity:</strong> 250 leaked WOs (37% of all leakage), 43.1% adoption.</li>
                            <li><strong>HDT3 has highest Kooner volume (152)</strong> but only 51.9% adoption with 141 leaked WOs.</li>
                            <li><strong>HPD1 remains critical:</strong> Only 2.9% adoption (1 Kooner vs 34 leaked).</li>
                            <li><strong>HTP2 surging:</strong> 22 Kooner WOs in WK06 (up from 7 in WK05), now at 83.2% ‚Äî near target.</li>
                        </ul>
                    </div>
                    <div class="insights-grid">
                        <div class="insight-card positive"><div class="insight-icon">‚úÖ</div><div class="insight-title">On Target Stations</div><div class="insight-text"><span class="insight-metric">HSL1, HCT2</span> ‚Äî 2 stations meeting 85%+ target.</div></div>
                        <div class="insight-card negative"><div class="insight-icon">üî¥</div><div class="insight-title">Critical: HPD1</div><div class="insight-text"><span class="insight-metric">2.9% adoption</span> ‚Äî Only 1 Kooner WO vs 34 leaked.</div></div>
                        <div class="insight-card warning"><div class="insight-icon">üéØ</div><div class="insight-title">Biggest Opportunity: HLA2</div><div class="insight-text"><span class="insight-metric">250 leaked WOs</span> ‚Äî 37% of total leakage.</div></div>
                        <div class="insight-card info"><div class="insight-icon">üìä</div><div class="insight-title">Near Target</div><div class="insight-text"><span class="insight-metric">HTP2 (83.2%), HDY1 (80.6%), HHO3 (80.0%)</span></div></div>
                    </div>
                </div>
                <div class="card full-width"><div class="card-header"><div class="card-title">üìà Weekly Kooner Volume by Station</div></div><div class="chart-container tall"><canvas id="stationWeeklyChart"></canvas></div></div>
                <div class="card full-width"><div class="card-header"><div class="card-title">Station Weekly Breakdown</div></div><div class="table-scroll"><table class="data-table"><thead><tr><th>Station</th><th>WK1</th><th>WK2</th><th>WK3</th><th>WK4</th><th>WK5</th><th>WK6</th><th>Total</th></tr></thead><tbody id="stationWeeklyTable"></tbody></table></div></div>
            </div>
        </div>

        <!-- ===== STATIONS TAB ===== -->
        <div id="stations" class="tab-content">
            <div class="main-grid">
                <div class="card full-width"><div class="card-header"><div class="card-title">Station Adoption Details</div><span class="card-badge badge-stations">12 STATIONS</span></div><table class="data-table"><thead><tr><th>Station</th><th>Location</th><th>Adoption</th><th>Kooner</th><th>Leaked</th><th>Total</th><th>Gap to 85%</th><th>Status</th></tr></thead><tbody id="stationFullTable"></tbody></table></div>
                <div class="card"><div class="card-header"><div class="card-title">Station Rankings</div></div><div class="chart-container tall"><canvas id="stationRankChart"></canvas></div></div>
                <div class="card"><div class="card-header"><div class="card-title">Leakage Distribution</div></div><div class="chart-container tall"><canvas id="leakageChart"></canvas></div></div>
            </div>
        </div>

        <!-- ===== DSPs TAB ===== -->
        <div id="dsps" class="tab-content">
            <div class="main-grid">
                <div class="card full-width">
                    <div class="card-header"><div class="card-title">DSP Priority List</div><span class="card-badge badge-dsps">BY STATION</span></div>
                    <div class="filter-row">
                        <button class="filter-btn active" onclick="filterStations('all',this)">All Stations</button>
                        <button class="filter-btn" onclick="filterStations('HLA2',this)">HLA2</button>
                        <button class="filter-btn" onclick="filterStations('HDT3',this)">HDT3</button>
                        <button class="filter-btn" onclick="filterStations('HAU1',this)">HAU1</button>
                        <button class="filter-btn" onclick="filterStations('HCL2',this)">HCL2</button>
                        <button class="filter-btn" onclick="filterStations('HPD1',this)">HPD1</button>
                    </div>
                    <div class="table-scroll" style="max-height:500px"><table class="data-table"><thead><tr><th>Station</th><th>Adoption</th><th>Kooner</th><th>Leaked</th><th>Opportunity</th><th>Priority</th></tr></thead><tbody id="dspTable"></tbody></table></div>
                </div>
            </div>
        </div>

        <!-- ===== SENTIMENT TAB (LIVE FROM GOOGLE SHEETS) ===== -->
        <div id="sentiment" class="tab-content">
            <div class="kpi-row" style="grid-template-columns:repeat(4,1fr)" id="sentimentKPIs">
                <div class="kpi-card"><div class="kpi-label">Survey Responses</div><div class="kpi-value" id="kpiResponses">‚Äî</div><div class="kpi-subtext" id="kpiRespondents">Loading...</div></div>
                <div class="kpi-card warning"><div class="kpi-label">Avg Satisfaction</div><div class="kpi-value yellow" id="kpiSatisfaction">‚Äî</div><div class="kpi-subtext">out of 5.0</div></div>
                <div class="kpi-card warning"><div class="kpi-label">Avg Timeliness</div><div class="kpi-value orange" id="kpiTimeliness">‚Äî</div><div class="kpi-subtext">out of 5.0</div></div>
                <div class="kpi-card warning"><div class="kpi-label">Avg Quality</div><div class="kpi-value orange" id="kpiQuality">‚Äî</div><div class="kpi-subtext">out of 5.0</div></div>
            </div>
            <div class="main-grid">
                <div class="card"><div class="card-header"><div class="card-title">Sentiment by DSP</div><span class="card-badge badge-live">‚óè LIVE</span></div><div class="chart-container"><canvas id="sentimentChart"></canvas></div></div>
                <div class="card"><div class="card-header"><div class="card-title">Sentiment vs Adoption</div></div><div class="chart-container"><canvas id="correlationChart"></canvas></div></div>
                <div class="card full-width"><div class="card-header"><div class="card-title">üí¨ Recent Feedback</div><span class="card-badge badge-live">‚óè LIVE FROM JOTFORM</span></div><div id="feedbackList"><div class="loading-indicator"><div class="loading-spinner"></div>Loading survey data...</div></div></div>
            </div>
        </div>

        <!-- ===== ACTIONS TAB ===== -->
        <div id="actions" class="tab-content">
            <div class="kpi-row" style="grid-template-columns:repeat(4,1fr)">
                <div class="kpi-card danger"><div class="kpi-label">Critical Priority</div><div class="kpi-value red">3</div><div class="kpi-subtext">Immediate action needed</div></div>
                <div class="kpi-card warning"><div class="kpi-label">High Priority</div><div class="kpi-value orange">4</div><div class="kpi-subtext">Address this week</div></div>
                <div class="kpi-card"><div class="kpi-label">Roundtable Actions</div><div class="kpi-value yellow" id="kpiRoundtableActions">‚Äî</div><div class="kpi-subtext">From meetings</div></div>
                <div class="kpi-card success"><div class="kpi-label">Improving</div><div class="kpi-value green">2</div><div class="kpi-subtext">Positive trend</div></div>
            </div>
            <div class="main-grid">
                <div class="card full-width"><div class="card-header"><div class="card-title">üéØ Priority Actions (Adoption + Sentiment)</div><span class="card-badge badge-sentiment">COMBINED SCORING</span></div><div class="action-list" id="actionList"></div></div>
                <div class="card full-width"><div class="card-header"><div class="card-title">üìã Action Matrix</div></div><table class="data-table"><thead><tr><th>Priority</th><th>Station</th><th>Adoption</th><th>Sentiment</th><th>Leaked</th><th>Key Issue</th><th>Recommended Action</th></tr></thead><tbody id="actionTable"></tbody></table></div>
                <div class="card full-width"><div class="card-header"><div class="card-title">üìÖ Roundtable Action Items</div><span class="card-badge badge-calendar">FROM EVENTS DATA</span></div><div id="roundtableActions"><div class="loading-indicator"><div class="loading-spinner"></div>Loading events data...</div></div></div>
            </div>
        </div>

        <!-- ===== CALENDAR TAB (LIVE FROM JSON) ===== -->
        <div id="calendar" class="tab-content">
            <div class="main-grid">
                <div class="card full-width">
                    <div class="card-header"><div class="card-title">üìÖ Engagement Calendar</div><span class="card-badge badge-live">‚óè LIVE</span></div>
                    <div class="legend">
                        <div class="legend-item"><div class="legend-dot" style="background:rgba(168,85,247,0.5)"></div>DSP Roundtable</div>
                        <div class="legend-item"><div class="legend-dot" style="background:rgba(0,255,136,0.5)"></div>Site Visit</div>
                        <div class="legend-item"><div class="legend-dot" style="background:rgba(0,212,255,0.5)"></div>Training</div>
                        <div class="legend-item"><div class="legend-dot" style="background:rgba(255,71,87,0.5)"></div>Deadline</div>
                        <div class="legend-item"><div class="legend-dot" style="background:rgba(255,165,2,0.5)"></div>Review</div>
                        <div class="legend-item"><div class="legend-dot" style="background:rgba(0,200,150,0.5)"></div>Newsletter</div>
                    </div>
                    <div class="calendar-nav">
                        <button class="calendar-nav-btn" onclick="changeMonth(-1)">‚Üê Previous</button>
                        <span class="calendar-month-title" id="calendarMonthTitle">February 2026</span>
                        <button class="calendar-nav-btn" onclick="changeMonth(1)">Next ‚Üí</button>
                    </div>
                    <div class="calendar-grid" id="calendarGrid"><div class="loading-indicator full-width"><div class="loading-spinner"></div>Loading calendar...</div></div>
                </div>
                <div class="card">
                    <div class="card-header"><div class="card-title">üìã Upcoming Events</div></div>
                    <div class="event-list" id="eventList"><div class="loading-indicator"><div class="loading-spinner"></div>Loading...</div></div>
                </div>
                <div class="card">
                    <div class="card-header"><div class="card-title">üìù Past Event Notes</div><span class="card-badge badge-dsps">ROUNDTABLE NOTES</span></div>
                    <div class="event-list" id="pastEventList"><div class="loading-indicator"><div class="loading-spinner"></div>Loading...</div></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Event Detail Modal -->
    <div class="modal-overlay" id="eventModal" onclick="closeModal(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <div>
                    <div class="modal-title" id="modalTitle">Event Title</div>
                    <div class="modal-subtitle" id="modalSubtitle">Date & Station</div>
                </div>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="modal-section" id="modalNotesSection">
                    <div class="modal-section-title">üìù Notes & Summary</div>
                    <div class="modal-notes" id="modalNotes">No notes available for this event.</div>
                </div>
                <div class="modal-section" id="modalActionsSection" style="display:none">
                    <div class="modal-section-title">‚úÖ Action Items</div>
                    <div class="modal-actions" id="modalActions"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
    // =========================================================================
    // CONFIGURATION ‚Äî UPDATE THESE VALUES
    // =========================================================================
    var CONFIG = {
        // Replace with your published Google Sheets CSV URL
        // In Google Sheets: File > Share > Publish to web > CSV
        SURVEY_SHEET_URL: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQXajk2Gv76ZmqD7YW8QXe6Rs7AOsfbJi3ueRJ4X_F9EX_63eWozXWFfQExGIcqYIjpwPT-L_nQudS6/pub?gid=2094613316&single=true&output=csv',

        // Column mapping ‚Äî adjust if your Jotform columns have different names
        // These should match the EXACT column headers in your Google Sheet
        SURVEY_COLUMNS: {
            date: 'Submission Date',
            dsp: 'DSP Shortcode',
            station: 'Station/Site Code',
            satisfaction: 'Overall satisfaction with Kooner\'s services this week:',
            timeliness: 'Timeliness of service:',
            quality: 'Quality of repairs:',
            issue: 'Did you experience any unresolved issues this week? If so, please briefly describe the issue(s)',
            suggestion: 'Is there anything else our team can do to better support you?',
            additionalFeedback: 'Please share any additional fleet or service-related feedback from this week.',
            contactName: 'Full Name',
            followUp: 'Would you like someone from the Kooner Ops team to follow up with you? If yes, please include your preferred method of contact.'
        },

        // Path to events JSON file (relative to index.html)
        EVENTS_JSON_PATH: 'events-data.json'
    };

    // =========================================================================
    // STATIC DATA (Station adoption, weekly WOs, action priorities)
    // =========================================================================
    var stationData = [
        {station:'HTP2',location:'Gibsonton, FL',kooner:89,leaked:18,adoption:83.2},
        {station:'HSL1',location:'Salt Lake City, UT',kooner:30,leaked:2,adoption:93.8},
        {station:'HHO3',location:'Porter, TX',kooner:96,leaked:24,adoption:80.0},
        {station:'HDY1',location:'Clayton, OH',kooner:54,leaked:13,adoption:80.6},
        {station:'HCT2',location:'Chattanooga, TN',kooner:24,leaked:4,adoption:85.7},
        {station:'HCL2',location:'Charlotte, NC',kooner:70,leaked:62,adoption:53.0},
        {station:'HDT3',location:'Romulus, MI',kooner:152,leaked:141,adoption:51.9},
        {station:'HMS2',location:'Lakeville, MN',kooner:37,leaked:33,adoption:52.9},
        {station:'HIN3',location:'South Bend, IN',kooner:16,leaked:20,adoption:44.4},
        {station:'HLA2',location:'Santa Clarita, CA',kooner:189,leaked:250,adoption:43.1},
        {station:'HAU1',location:'Austin, TX',kooner:53,leaked:78,adoption:40.5},
        {station:'HPD1',location:'Portland, OR',kooner:1,leaked:34,adoption:2.9}
    ];

    var weeklyByStation = {
        'HAU1':{WK1:6,WK2:12,WK3:10,WK4:14,WK5:3,WK6:6,total:53},
        'HCL2':{WK1:1,WK2:5,WK3:29,WK4:8,WK5:10,WK6:16,total:70},
        'HCT2':{WK1:null,WK2:4,WK3:5,WK4:7,WK5:2,WK6:4,total:24},
        'HDT3':{WK1:9,WK2:15,WK3:17,WK4:26,WK5:44,WK6:23,total:152},
        'HDY1':{WK1:9,WK2:20,WK3:10,WK4:6,WK5:null,WK6:5,total:54},
        'HHO3':{WK1:6,WK2:22,WK3:13,WK4:19,WK5:15,WK6:12,total:96},
        'HIN3':{WK1:1,WK2:5,WK3:4,WK4:2,WK5:null,WK6:5,total:16},
        'HLA2':{WK1:9,WK2:20,WK3:23,WK4:42,WK5:41,WK6:37,total:189},
        'HMS2':{WK1:2,WK2:6,WK3:5,WK4:11,WK5:9,WK6:2,total:37},
        'HPD1':{WK1:null,WK2:null,WK3:null,WK4:1,WK5:null,WK6:null,total:1},
        'HSL1':{WK1:1,WK2:4,WK3:5,WK4:5,WK5:5,WK6:10,total:30},
        'HTP2':{WK1:3,WK2:20,WK3:8,WK4:16,WK5:7,WK6:22,total:89}
    };
    var weekTotals = {WK1:48,WK2:132,WK3:125,WK4:156,WK5:139,WK6:142};

    var actionData = [
        {station:'HPD1',location:'Portland, OR',adoption:2.9,leaked:34,sentiment:null,issue:'No survey data - unknown DSP engagement',action:'Emergency: Identify DSP contacts, schedule immediate roundtable',priority:'critical'},
        {station:'HLA2',location:'Santa Clarita, CA',adoption:43.1,leaked:250,sentiment:2.6,issue:'ARMA improving (5/5 recent), but historical issues',action:'Continue momentum with Jose M. Expand to other DSPs at station',priority:'critical'},
        {station:'HAU1',location:'Austin, TX',adoption:40.5,leaked:78,sentiment:null,issue:'No survey data - dropped from 88% to 40%',action:'Urgent site visit to identify root cause of decline',priority:'critical'},
        {station:'HDT3',location:'Romulus, MI',adoption:51.9,leaked:141,sentiment:2.1,issue:'ALAB (1/5) and SFRM (3.1/5) mixed feedback',action:'Address ALAB concerns first - timeliness and rework issues',priority:'high'},
        {station:'HIN3',location:'South Bend, IN',adoption:44.4,leaked:20,sentiment:2.3,issue:'MAEP reports unresolved issues, wrong parts',action:'Quality review with tech team, parts inventory check',priority:'high'},
        {station:'HCL2',location:'Charlotte, NC',adoption:53.0,leaked:62,sentiment:5.0,issue:'D4DS loves service but adoption still low',action:'Identify other DSPs at station causing leakage',priority:'high'},
        {station:'HTP2',location:'Gibsonton, FL',adoption:83.2,leaked:18,sentiment:2.3,issue:'ORMP: contact laid off, no visibility into WOs',action:'Near target ‚Äî assign new contact, maintain WK06 momentum',priority:'high'},
        {station:'HMS2',location:'Lakeville, MN',adoption:52.9,leaked:33,sentiment:null,issue:'No survey data',action:'Schedule DSP roundtable to gather feedback',priority:'medium'},
        {station:'HHO3',location:'Porter, TX',adoption:80.0,leaked:24,sentiment:null,issue:'Near target but no survey feedback',action:'Quick wins to push over 85%, gather DSP input',priority:'medium'},
        {station:'HDY1',location:'Clayton, OH',adoption:80.6,leaked:13,sentiment:null,issue:'Very close to target',action:'Final push to 85% - identify remaining blockers',priority:'low'}
    ];

    // =========================================================================
    // GLOBAL STATE
    // =========================================================================
    var calendarEvents = [];
    var allRoundtableActions = [];
    var surveyData = [];
    var currentMonth = 1;
    var currentYear = 2026;
    var monthNames = ['January','February','March','April','May','June','July','August','September','October','November','December'];
    var sentimentChartInstance = null;
    var correlationChartInstance = null;

    // =========================================================================
    // DATA LOADING ‚Äî SURVEY (Google Sheets)
    // =========================================================================
    function loadSurveyData() {
        var url = CONFIG.SURVEY_SHEET_URL;
        if (!url || url === 'YOUR_GOOGLE_SHEETS_PUBLISHED_CSV_URL_HERE') {
            console.log('No Google Sheets URL configured ‚Äî using fallback survey data');
            useFallbackSurveyData();
            return;
        }

        Papa.parse(url, {
            download: true,
            header: true,
            skipEmptyLines: true,
            complete: function(results) {
                if (results.errors.length > 0) {
                    console.warn('CSV parse errors:', results.errors);
                }
                if (results.data.length === 0) {
                    console.warn('No survey data found ‚Äî using fallback');
                    useFallbackSurveyData();
                    return;
                }

                var cols = CONFIG.SURVEY_COLUMNS;
                surveyData = results.data.map(function(row) {
                    // Parse ratings - handle both numeric ("3") and text ("3 - Neutral") formats
                    function parseRating(val) {
                        if (!val) return 0;
                        var str = String(val).trim();
                        var num = parseFloat(str);
                        if (!isNaN(num)) return num;
                        // Try extracting leading number from text like "3 - Neutral"
                        var match = str.match(/^(\d+)/);
                        return match ? parseFloat(match[1]) : 0;
                    }

                    // Combine suggestion + additional feedback
                    var suggestion = (row[cols.suggestion] || '').trim();
                    var additional = (row[cols.additionalFeedback] || '').trim();
                    var combined = [suggestion, additional].filter(function(s) { return s.length > 0; }).join(' | ');

                    return {
                        date: row[cols.date] || '',
                        dsp: (row[cols.dsp] || '').trim().toUpperCase(),
                        station: (row[cols.station] || '').trim().toUpperCase(),
                        contactName: (row[cols.contactName] || '').trim(),
                        satisfaction: parseRating(row[cols.satisfaction]),
                        timeliness: parseRating(row[cols.timeliness]),
                        quality: parseRating(row[cols.quality]),
                        issue: (row[cols.issue] || '').trim(),
                        suggestion: combined,
                        followUp: (row[cols.followUp] || '').trim()
                    };
                }).filter(function(r) { return r.dsp && r.station; });

                renderSentimentTab(surveyData);
            },
            error: function(err) {
                console.error('Failed to load Google Sheets CSV:', err);
                useFallbackSurveyData();
            }
        });
    }

    function useFallbackSurveyData() {
        surveyData = [
            {date:"Feb 16",dsp:"SFRM",station:"HDT3",satisfaction:3,timeliness:2,quality:4,issue:"Unit 0160 grounded 02/11 for engine issues - still not diagnosed. Unit 5768 grounded 02/09 for HVAC - awaiting repairs due to estimate/pricing issues.",suggestion:"Need more techs - stretched thin across 2 DSPs. No weekend work causing delays. Techs should comingle on WOs to avoid knowledge gaps between shifts. 14 grounded vehicles, 8 outsourced to other vendors."},
            {date:"Feb 10",dsp:"SFRM",station:"HDT3",satisfaction:4,timeliness:4,quality:4,issue:"Unit 2974 pending diagnostics for a few days",suggestion:"More availability for weekend issues, over the road calls."},
            {date:"Feb 9",dsp:"ORMP",station:"HTP2",satisfaction:2,timeliness:2,quality:4,issue:"Multiple WOs not looked at since 2/4. Helpful contact laid off.",suggestion:""},
            {date:"Feb 9",dsp:"ARMA",station:"HLA2",satisfaction:5,timeliness:5,quality:5,issue:"",suggestion:"Jose Madrigal is GREAT! Very professional and attentive."},
            {date:"Feb 2",dsp:"SFRM",station:"HDT3",satisfaction:3,timeliness:3,quality:3,issue:"",suggestion:"Need 2 day techs. Better communication."},
            {date:"Jan 26",dsp:"ALAB",station:"HDT3",satisfaction:1,timeliness:1,quality:1,issue:"Lack of timely repairs. Same issue after ungrounding.",suggestion:"Timely repairs needed."},
            {date:"Jan 12",dsp:"D4DS",station:"HCL2",satisfaction:5,timeliness:5,quality:5,issue:"",suggestion:"Supervisor got more vehicles running in one evening than any mechanic in 5 years."},
            {date:"Jan 6",dsp:"ORMP",station:"HTP2",satisfaction:2,timeliness:2,quality:2,issue:"No paperwork after 7 days. Brakes still bad.",suggestion:"Need schedule access."},
            {date:"Jan 6",dsp:"PRLC",station:"HSL1",satisfaction:4,timeliness:5,quality:3,issue:"",suggestion:"Service request to vehicle return is smooth. Techs are great. Paperwork/invoicing process needs improvement."},
            {date:"Jan 5",dsp:"SFRM",station:"HDT3",satisfaction:3,timeliness:2,quality:2,issue:"",suggestion:"Need better field supervision of technicians. Who is validating completeness and quality of their work?"},
            {date:"Jan 5",dsp:"ARMA",station:"HLA2",satisfaction:1,timeliness:1,quality:1,issue:"No work orders submitted.",suggestion:"Better communication."},
            {date:"Dec 30",dsp:"MAEP",station:"HIN3",satisfaction:2,timeliness:2,quality:3,issue:"Most issues not resolved. Wrong brake parts ordered, then additional issues found. Had to outsource repair.",suggestion:""}
        ];
        renderSentimentTab(surveyData);
    }

    function renderSentimentTab(data) {
        // Calculate KPIs
        var totalResponses = data.length;
        var dsps = {};
        var totalSat = 0, totalTime = 0, totalQual = 0;

        data.forEach(function(r) {
            if (!dsps[r.dsp]) dsps[r.dsp] = [];
            dsps[r.dsp].push(r);
            totalSat += r.satisfaction;
            totalTime += r.timeliness;
            totalQual += r.quality;
        });

        var avgSat = totalResponses > 0 ? (totalSat / totalResponses).toFixed(1) : '‚Äî';
        var avgTime = totalResponses > 0 ? (totalTime / totalResponses).toFixed(1) : '‚Äî';
        var avgQual = totalResponses > 0 ? (totalQual / totalResponses).toFixed(1) : '‚Äî';

        document.getElementById('kpiResponses').textContent = totalResponses;
        document.getElementById('kpiRespondents').textContent = 'From ' + Object.keys(dsps).length + ' DSPs';
        document.getElementById('kpiSatisfaction').textContent = avgSat;
        document.getElementById('kpiTimeliness').textContent = avgTime;
        document.getElementById('kpiQuality').textContent = avgQual;

        // Render feedback list
        renderFeedbackList(data);
        renderSentimentCharts(dsps);
    }

    function renderFeedbackList(data) {
        var c = document.getElementById('feedbackList'), h = '';
        var sorted = data.slice().sort(function(a, b) {
            return new Date(b.date) - new Date(a.date);
        });

        if (sorted.length === 0) {
            c.innerHTML = '<div class="no-events">No survey responses yet</div>';
            return;
        }

        for (var i = 0; i < sorted.length; i++) {
            var f = sorted[i];
            var nameTag = f.contactName ? '<span style="color:var(--text-primary);font-weight:500;margin-left:8px">' + f.contactName + '</span>' : '';
            var followUpTag = f.followUp ? '<div style="margin-top:10px;padding:8px 12px;background:rgba(168,85,247,0.1);border-radius:8px;font-size:0.8rem;color:var(--accent-purple)"><strong>Follow-up requested:</strong> ' + f.followUp + '</div>' : '';
            h += '<div class="feedback-card"><div class="feedback-header"><div class="feedback-meta"><span class="station-name">' + f.dsp + '</span><span class="action-station">' + f.station + '</span>' + nameTag + '<span class="feedback-date">' + f.date + '</span></div><div class="feedback-scores"><div class="score-mini"><span class="score-mini-label">Sat</span><span class="score-mini-value" style="color:' + getScoreColor(f.satisfaction) + '">' + f.satisfaction + '</span></div><div class="score-mini"><span class="score-mini-label">Time</span><span class="score-mini-value" style="color:' + getScoreColor(f.timeliness) + '">' + f.timeliness + '</span></div><div class="score-mini"><span class="score-mini-label">Qual</span><span class="score-mini-value" style="color:' + getScoreColor(f.quality) + '">' + f.quality + '</span></div></div></div>';
            if (f.issue) h += '<div class="feedback-text issue"><strong>Issue:</strong> ' + f.issue + '</div>';
            if (f.suggestion) h += '<div class="feedback-text suggestion"><strong>Feedback:</strong> ' + f.suggestion + '</div>';
            h += followUpTag;
            h += '</div>';
        }
        c.innerHTML = h;
    }

    function renderSentimentCharts(dspGroups) {
        var dspNames = Object.keys(dspGroups).sort();
        var satData = [], timeData = [], qualData = [];
        var scatterData = [];

        dspNames.forEach(function(dsp) {
            var rows = dspGroups[dsp];
            var avgS = rows.reduce(function(s, r) { return s + r.satisfaction; }, 0) / rows.length;
            var avgT = rows.reduce(function(s, r) { return s + r.timeliness; }, 0) / rows.length;
            var avgQ = rows.reduce(function(s, r) { return s + r.quality; }, 0) / rows.length;
            satData.push(avgS);
            timeData.push(avgT);
            qualData.push(avgQ);

            var avgAll = (avgS + avgT + avgQ) / 3;
            var station = rows[0].station;
            var stInfo = stationData.find(function(s) { return s.station === station; });
            var adoption = stInfo ? stInfo.adoption : 50;
            scatterData.push({ x: avgAll, y: adoption, label: dsp });
        });

        // Destroy old charts if they exist
        if (sentimentChartInstance) sentimentChartInstance.destroy();
        if (correlationChartInstance) correlationChartInstance.destroy();

        sentimentChartInstance = new Chart(document.getElementById('sentimentChart'), {
            type: 'bar',
            data: {
                labels: dspNames,
                datasets: [
                    { label: 'Satisfaction', data: satData, backgroundColor: 'rgba(168,85,247,0.7)', borderRadius: 4 },
                    { label: 'Timeliness', data: timeData, backgroundColor: 'rgba(0,212,255,0.7)', borderRadius: 4 },
                    { label: 'Quality', data: qualData, backgroundColor: 'rgba(255,217,61,0.7)', borderRadius: 4 }
                ]
            },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { labels: { color: '#8b8b9a' } } }, scales: { y: { beginAtZero: true, max: 5, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#8b8b9a' } }, x: { grid: { display: false }, ticks: { color: '#8b8b9a' } } } }
        });

        correlationChartInstance = new Chart(document.getElementById('correlationChart'), {
            type: 'scatter',
            data: {
                datasets: [{
                    label: 'DSPs',
                    data: scatterData,
                    backgroundColor: function(ctx) {
                        var v = ctx.raw;
                        if (!v) return '#8b8b9a';
                        if (v.y >= 85) return 'rgba(0,255,136,0.8)';
                        if (v.y >= 50) return 'rgba(255,165,2,0.8)';
                        return 'rgba(255,71,87,0.8)';
                    },
                    pointRadius: 12,
                    pointHoverRadius: 15
                }]
            },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }, tooltip: { callbacks: { label: function(ctx) { var p = ctx.raw; return p.label + ': ' + p.x.toFixed(1) + ' sent, ' + p.y.toFixed(1) + '% adopt'; } } } }, scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Adoption %', color: '#8b8b9a' }, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#8b8b9a', callback: function(v) { return v + '%'; } } }, x: { beginAtZero: true, max: 5, title: { display: true, text: 'Sentiment', color: '#8b8b9a' }, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#8b8b9a' } } } }
        });
    }

    // =========================================================================
    // DATA LOADING ‚Äî EVENTS (JSON file)
    // =========================================================================
    // Fallback events data (used when events-data.json can't be fetched, e.g. local preview)
    var FALLBACK_EVENTS = [
        {date:'2026-02-09',title:'HMS2 Roundtable',type:'roundtable',station:'HMS2',time:'10:00 AM',notes:'<strong>Key Issues:</strong> Severe communication delays - questions unanswered 6-8 hrs, multi-day gaps despite 60-80 people in Kooner chat. Steven: Never experienced such delay vs prior vendors.<br><br><strong>Safety/Compliance Failures:</strong> Truck 21 passed Federal DOT but failed MN inspection with visible drag link issues. Truck 20 had 5 federal DOT failures caught by external shop. Wrong stickers on wrong vehicles.<br><br><strong>Work Quality:</strong> Truck 1 urgent WO at 8am, tech sat idle until 12:15pm. WOs marked complete when repairs not finished. Multiple recreations needed.<br><br><strong>Root Causes:</strong> Coverage gaps across shifts, tech (Michael) attendance/training issues, no escalation protocols, DSPs unclear on contacts.<br><br><strong>Solutions Discussed:</strong> David (experienced manager tech) deploying next week for training/oversight. Formal dispatch schedule being created. This is 2nd escalation - relationship at risk.',actionItems:[{owner:'Brooke/Alberto',action:'Provide direct numbers for 24/7 contact',status:'done'},{owner:'Ash',action:'Send dispatch schedule with roles/coverage times',status:'done'},{owner:'David',action:'Visit HMS2 next week for training & process review',status:'done'},{owner:'Steven',action:'Document VINs, dates, WO details via email + chat',status:'done'},{owner:'Team',action:'Schedule site visit after David training complete',status:'done'},{owner:'Team',action:'Establish escalation protocols for urgent repairs',status:'done'}]},
        {date:'2026-02-10',title:'HCL2 Roundtable',type:'roundtable',station:'HCL2',time:'2:00 PM',notes:'<strong>Key Issues:</strong> D4DS (Andrea) down to 6 of 17 trucks. Multiple vehicles grounded due to incomplete PMs - one sitting since Jan 22. Communication breakdown: no responses since Saturday, messages unanswered for days. Unexpected tech departure caused service disruption.<br><br><strong>Root Causes:</strong> No proactive status updates, parts availability delays, badge access issues, two intake systems creating confusion, no real-time WO visibility for DSPs.<br><br><strong>Solutions Discussed:</strong> Justin Ellis relocating permanently (6pm-2am shift), Eugene deploying to help clear backlog. Relay Garage integration planned for mid-March with Fleet Portal scheduling.',actionItems:[{owner:'Ash',action:'Provide cell numbers for direct contact',status:'done'},{owner:'Ash',action:'Daily AM updates in Chime on overnight completions',status:'done'},{owner:'Kathy',action:'Send contact list with roles',status:'done'},{owner:'Team',action:'Provide ETA doc for all 28 open WOs',status:'done'},{owner:'Mark',action:'Meet Justin to set up vehicle shuttle system',status:'done'},{owner:'Mark',action:'Set up key box at FC entrance',status:'done'},{owner:'Andrea',action:'Share D4 WOs in Chime for reconciliation',status:'done'}]},
        {date:'2026-02-11',title:'HPD1 Roundtable',type:'roundtable',station:'HPD1',time:'11:00 AM',notes:'<strong>Key Context:</strong> Unique site - only DSP at location, co-located with FC, 20-30 min from other Amazon facilities. Robert (DSP) has existing vendor relationship (1.5 yrs) with dedicated 1-2 techs who know his fleet.<br><br><strong>Service Gaps Identified:</strong> No proactive PM scheduling communication. No notification when repairs completed. Inconsistent tech coverage. Kooner removed dedicated Vancouver travel tech due to volume decrease. BOX invoice process implemented without DSP awareness.<br><br><strong>Impact:</strong> Ryan: Biggest concern is fleet constraints from maintenance causing dropped routes.<br><br><strong>Solutions Discussed:</strong> Tech integration within 1 month for comms. Amazon Fleet Portal integration end of March/April. Dedicated tech Michael available (5-10 min from site). Moving from Chime to Slack.',actionItems:[{owner:'Team',action:'Schedule follow-up meeting Fri or Mon/Tue same time',status:'done'},{owner:'Team',action:'Send meeting invite to attendees with forwarding option',status:'done'},{owner:'Meeting',action:'Document specific communication expectations',status:'done'},{owner:'Meeting',action:'Align on service level requirements',status:'done'},{owner:'Meeting',action:'Introduce dedicated technician Michael',status:'done'},{owner:'Meeting',action:'Establish escalation procedures',status:'done'}]},
        {date:'2026-02-16',title:'HDY1 Roundtable',type:'roundtable',station:'HDY1',time:'',notes:'<strong>Communication & Process Issues:</strong> New tech Charles transitioned from middle mile without proper last mile training. Missing badge access. No direct communication established with DSP fleet managers. Previous tech Tim left suddenly, creating rushed transition.<br><br><strong>Service Quality & Documentation Problems:</strong> Invoice delays impacting truck availability. PMs completed overnight but invoices not uploaded to Box until 4pm next day. DOT inspection quality issue at TLG. Weather delays affecting timely service.<br><br><strong>Daily Operations & Scheduling:</strong> Charles currently works Mon-Fri 8am-5pm. May need later hours for vehicles returning from routes. New daily reporting system starting.',actionItems:[{owner:'Brandon',action:'Get Charles badge access, follow up with station today',status:'pending'},{owner:'Ash',action:'Share Charles contact info with DSP fleet managers',status:'pending'},{owner:'Ash',action:'Continue daily schedule updates in Chime',status:'pending'},{owner:'Ash',action:'Review DOT inspection training with Charles',status:'pending'},{owner:'Brooke',action:'Send escalation path contacts by EOD',status:'pending'},{owner:'Brooke',action:'Formalize SOP document',status:'pending'},{owner:'DSP teams',action:'Audit daily schedules, prioritize WOs, tag team in Chime',status:'pending'},{owner:'Drew',action:'Provide FIM details for DOT inspection incident',status:'pending'}]},
        {date:'2026-03-02',title:'DSP Monthly Newsletter #1',type:'newsletter',station:'All',time:'',notes:'First edition of the DSP Monthly Newsletter',actionItems:[]}
    ];

    function processEventsData(eventsArray) {
        calendarEvents = eventsArray;
        allRoundtableActions = [];

        calendarEvents.forEach(function(evt) {
            if (evt.actionItems && evt.actionItems.length > 0) {
                evt.actionItems.forEach(function(ai) {
                    allRoundtableActions.push({
                        station: evt.station,
                        date: formatShortDate(evt.date),
                        owner: ai.owner,
                        action: ai.action,
                        status: ai.status
                    });
                });
            }
        });

        document.getElementById('kpiRoundtableActions').textContent = allRoundtableActions.length;
        populateCalendar();
        populateEventList();
        populatePastEventList();
        populateRoundtableActions();
    }

    function loadEventsData() {
        fetch(CONFIG.EVENTS_JSON_PATH)
            .then(function(res) {
                if (!res.ok) throw new Error('Failed to load events: ' + res.status);
                return res.json();
            })
            .then(function(data) {
                processEventsData(data.events || []);
            })
            .catch(function(err) {
                console.log('Using embedded events data (fetch failed: ' + err.message + ')');
                processEventsData(FALLBACK_EVENTS);
            });
    }

    function formatShortDate(dateStr) {
        var d = new Date(dateStr + 'T00:00:00');
        var months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
        return months[d.getMonth()] + ' ' + d.getDate();
    }

    // =========================================================================
    // UI FUNCTIONS
    // =========================================================================
    function showTab(tabId) {
        document.querySelectorAll('.tab-content').forEach(function(c) { c.classList.remove('active'); });
        document.querySelectorAll('.nav-tab').forEach(function(t) { t.classList.remove('active'); });
        document.getElementById(tabId).classList.add('active');
        event.target.classList.add('active');
    }

    function filterStations(filter, btn) {
        document.querySelectorAll('.filter-btn').forEach(function(b) { b.classList.remove('active'); });
        btn.classList.add('active');
        populateDSPTable(filter);
    }

    function getScoreColor(s) { if (s >= 4) return 'var(--accent-green)'; if (s >= 3) return 'var(--accent-yellow)'; if (s >= 2) return 'var(--accent-orange)'; return 'var(--accent-red)'; }
    function getScoreClass(s) { if (s >= 4) return 'score-' + Math.round(s); if (s >= 3) return 'score-3'; if (s >= 2) return 'score-2'; return 'score-1'; }

    // =========================================================================
    // STATIC TABLE POPULATION
    // =========================================================================
    function populateStationQuickTable() {
        var t = document.getElementById('stationQuickTable'), h = '';
        var sorted = stationData.slice().sort(function(a, b) { return b.adoption - a.adoption; });
        for (var i = 0; i < sorted.length; i++) {
            var s = sorted[i], ot = s.adoption >= 85;
            h += '<tr><td><span class="station-name">' + s.station + '</span></td><td style="color:' + (ot ? 'var(--accent-green)' : 'var(--accent-red)') + '">' + s.adoption.toFixed(1) + '%</td><td>' + s.kooner + '</td><td>' + s.leaked + '</td><td><span class="status-pill ' + (ot ? 'on-target' : 'below-target') + '"><span class="status-dot"></span>' + (ot ? 'On Target' : 'Below') + '</span></td></tr>';
        }
        t.innerHTML = h;
    }

    function populateOpportunityTable() {
        var t = document.getElementById('opportunityTable'), h = '';
        var sorted = stationData.slice().filter(function(s) { return s.leaked > 0; }).sort(function(a, b) { return b.leaked - a.leaked; });
        for (var i = 0; i < Math.min(sorted.length, 8); i++) {
            var s = sorted[i];
            var potential = ((s.kooner + s.leaked) / (811 + 679) * 100).toFixed(1);
            h += '<tr><td><span class="station-name">' + s.station + '</span></td><td style="color:var(--accent-red)">' + s.leaked + '</td><td>' + s.adoption.toFixed(1) + '%</td><td>' + potential + '% of total</td></tr>';
        }
        t.innerHTML = h;
    }

    function populateStationFullTable() {
        var t = document.getElementById('stationFullTable'), h = '';
        var sorted = stationData.slice().sort(function(a, b) { return b.adoption - a.adoption; });
        for (var i = 0; i < sorted.length; i++) {
            var s = sorted[i], ot = s.adoption >= 85, gap = 85 - s.adoption, total = s.kooner + s.leaked;
            h += '<tr><td><span class="station-name">' + s.station + '</span></td><td>' + (s.location || '‚Äî') + '</td><td style="color:' + (ot ? 'var(--accent-green)' : 'var(--accent-red)') + '">' + s.adoption.toFixed(1) + '%</td><td>' + s.kooner + '</td><td>' + s.leaked + '</td><td>' + total + '</td><td style="color:' + (gap > 0 ? 'var(--accent-red)' : 'var(--accent-green)') + '">' + (gap > 0 ? '+' : '') + gap.toFixed(1) + '%</td><td><span class="status-pill ' + (ot ? 'on-target' : 'below-target') + '"><span class="status-dot"></span>' + (ot ? 'On Target' : 'Below') + '</span></td></tr>';
        }
        t.innerHTML = h;
    }

    function populateStationWeeklyTable() {
        var t = document.getElementById('stationWeeklyTable'), h = '';
        var stations = Object.keys(weeklyByStation).sort(function(a, b) { return weeklyByStation[b].total - weeklyByStation[a].total; });
        for (var i = 0; i < stations.length; i++) {
            var st = stations[i], w = weeklyByStation[st];
            h += '<tr><td><span class="station-name">' + st + '</span></td><td>' + (w.WK1 || '‚Äî') + '</td><td>' + (w.WK2 || '‚Äî') + '</td><td>' + (w.WK3 || '‚Äî') + '</td><td>' + (w.WK4 || '‚Äî') + '</td><td>' + (w.WK5 || '‚Äî') + '</td><td>' + (w.WK6 || '‚Äî') + '</td><td><strong>' + w.total + '</strong></td></tr>';
        }
        h += '<tr style="background:var(--bg-card-hover)"><td><strong>TOTAL</strong></td><td><strong>' + weekTotals.WK1 + '</strong></td><td><strong>' + weekTotals.WK2 + '</strong></td><td><strong>' + weekTotals.WK3 + '</strong></td><td><strong>' + weekTotals.WK4 + '</strong></td><td><strong>' + weekTotals.WK5 + '</strong></td><td><strong>' + weekTotals.WK6 + '</strong></td><td><strong>798</strong></td></tr>';
        t.innerHTML = h;
    }

    function populateDSPTable(filter) {
        filter = filter || 'all';
        var t = document.getElementById('dspTable'), h = '';
        var filtered = filter === 'all' ? stationData : stationData.filter(function(s) { return s.station === filter; });
        filtered = filtered.slice().sort(function(a, b) { return b.leaked - a.leaked; });
        for (var i = 0; i < filtered.length; i++) {
            var s = filtered[i];
            if (s.leaked === 0) continue;
            var priority = s.adoption < 20 ? 'critical' : s.adoption < 50 ? 'high' : s.adoption < 70 ? 'medium' : 'low';
            var opp = (s.leaked / 594 * 100).toFixed(1);
            h += '<tr><td><span class="station-name">' + s.station + '</span></td><td style="color:' + (s.adoption >= 85 ? 'var(--accent-green)' : 'var(--accent-red)') + '">' + s.adoption.toFixed(1) + '%</td><td>' + s.kooner + '</td><td>' + s.leaked + '</td><td>' + opp + '% of leakage</td><td><span class="priority-pill priority-' + priority + '">' + priority + '</span></td></tr>';
        }
        t.innerHTML = h;
    }

    function populateActionCards() {
        var c = document.getElementById('actionList'), h = '';
        var sorted = actionData.slice().sort(function(a, b) {
            var po = { critical: 0, high: 1, medium: 2, low: 3 };
            return po[a.priority] - po[b.priority];
        }).slice(0, 6);
        for (var i = 0; i < sorted.length; i++) {
            var a = sorted[i];
            var sentimentHtml = a.sentiment ? '<div class="action-stat"><span class="action-stat-label">Sentiment</span><span class="action-stat-value ' + (a.sentiment >= 3 ? 'green' : a.sentiment >= 2 ? 'orange' : 'red') + '">' + a.sentiment.toFixed(1) + '/5</span></div>' : '<div class="action-stat"><span class="action-stat-label">Sentiment</span><span class="action-stat-value" style="color:var(--text-muted)">No data</span></div>';
            h += '<div class="action-card ' + a.priority + '"><div class="action-header"><span class="action-dsp">' + a.station + '</span><span class="priority-pill priority-' + a.priority + '">' + a.priority + '</span></div><div class="action-stats"><div class="action-stat"><span class="action-stat-label">Adoption</span><span class="action-stat-value red">' + a.adoption.toFixed(1) + '%</span></div><div class="action-stat"><span class="action-stat-label">Leaked</span><span class="action-stat-value orange">' + a.leaked + '</span></div>' + sentimentHtml + '</div><div class="action-feedback">üí° ' + a.action + '</div></div>';
        }
        c.innerHTML = h;
    }

    function populateActionTable() {
        var t = document.getElementById('actionTable'), h = '';
        for (var i = 0; i < actionData.length; i++) {
            var a = actionData[i];
            var sentimentHtml = a.sentiment ? '<span class="sentiment-score ' + getScoreClass(a.sentiment) + '">' + a.sentiment.toFixed(1) + '</span>' : '<span style="color:var(--text-muted)">‚Äî</span>';
            h += '<tr><td><span class="priority-pill priority-' + a.priority + '">' + a.priority + '</span></td><td><span class="station-name">' + a.station + '</span><br><span style="font-size:0.75rem;color:var(--text-muted)">' + a.location + '</span></td><td style="color:' + (a.adoption >= 85 ? 'var(--accent-green)' : 'var(--accent-red)') + '">' + a.adoption.toFixed(1) + '%</td><td>' + sentimentHtml + '</td><td>' + a.leaked + '</td><td style="font-size:0.85rem;color:var(--text-secondary)">' + a.issue + '</td><td style="font-size:0.85rem">' + a.action + '</td></tr>';
        }
        t.innerHTML = h;
    }

    // =========================================================================
    // CALENDAR (from loaded events JSON)
    // =========================================================================
    function changeMonth(delta) {
        currentMonth += delta;
        if (currentMonth > 11) { currentMonth = 0; currentYear++; }
        if (currentMonth < 0) { currentMonth = 11; currentYear--; }
        populateCalendar();
    }

    function populateCalendar() {
        var grid = document.getElementById('calendarGrid');
        var titleEl = document.getElementById('calendarMonthTitle');
        titleEl.textContent = monthNames[currentMonth] + ' ' + currentYear;

        var days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
        var h = '';
        for (var i = 0; i < 7; i++) h += '<div class="calendar-header">' + days[i] + '</div>';

        var daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
        var firstDay = new Date(currentYear, currentMonth, 1).getDay();
        var today = new Date();

        for (var i = 0; i < firstDay; i++) h += '<div class="calendar-day other-month"></div>';

        for (var d = 1; d <= daysInMonth; d++) {
            var monthStr = (currentMonth + 1) < 10 ? '0' + (currentMonth + 1) : (currentMonth + 1);
            var dayStr = d < 10 ? '0' + d : d;
            var dateStr = currentYear + '-' + monthStr + '-' + dayStr;
            var isToday = (today.getFullYear() === currentYear && today.getMonth() === currentMonth && today.getDate() === d);
            var dayEvents = calendarEvents.filter(function(e) { return e.date === dateStr; });

            h += '<div class="calendar-day' + (isToday ? ' today' : '') + '">';
            h += '<div class="calendar-date">' + d + '</div>';
            for (var e = 0; e < dayEvents.length; e++) {
                var evt = dayEvents[e];
                h += '<div class="calendar-event ' + evt.type + '" onclick="openEventModal(\'' + evt.date + '\')">' + evt.title + '</div>';
            }
            h += '</div>';
        }
        grid.innerHTML = h;
    }

    function openEventModal(dateStr) {
        var evt = calendarEvents.find(function(e) { return e.date === dateStr; });
        if (!evt) return;

        var modal = document.getElementById('eventModal');
        var d = new Date(dateStr + 'T00:00:00');
        var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        var dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];

        document.getElementById('modalTitle').textContent = evt.title;
        document.getElementById('modalSubtitle').innerHTML = '<span class="event-type calendar-event ' + evt.type + '">' + evt.type.replace('-', ' ') + '</span> ¬∑ ' + dayNames[d.getDay()] + ', ' + months[d.getMonth()] + ' ' + d.getDate() + ', ' + d.getFullYear() + (evt.time ? ' ¬∑ ' + evt.time : '') + (evt.station ? ' ¬∑ üìç ' + evt.station : '');

        var notesSection = document.getElementById('modalNotesSection');
        var notesEl = document.getElementById('modalNotes');
        if (evt.notes && evt.notes.length > 0) {
            notesSection.style.display = 'block';
            notesEl.innerHTML = evt.notes;
        } else {
            notesSection.style.display = 'block';
            notesEl.innerHTML = '<em style="color:var(--text-muted)">No notes available for this event yet.</em>';
        }

        var actionsSection = document.getElementById('modalActionsSection');
        var actionsEl = document.getElementById('modalActions');
        if (evt.actionItems && evt.actionItems.length > 0) {
            actionsSection.style.display = 'block';
            var actionsHtml = '';
            evt.actionItems.forEach(function(a) {
                actionsHtml += '<div class="modal-action-item"><span class="modal-action-owner">' + a.owner + '</span><span class="modal-action-text">' + a.action + '</span><span class="action-status ' + a.status + '">' + a.status + '</span></div>';
            });
            actionsEl.innerHTML = actionsHtml;
        } else {
            actionsSection.style.display = 'none';
        }

        modal.classList.add('active');
    }

    function closeModal(e) {
        if (e && e.target !== e.currentTarget) return;
        document.getElementById('eventModal').classList.remove('active');
    }

    document.addEventListener('keydown', function(e) { if (e.key === 'Escape') closeModal(); });

    function populateEventList() {
        var list = document.getElementById('eventList');
        var today = new Date();
        var upcoming = calendarEvents.filter(function(e) { return new Date(e.date + 'T00:00:00') >= today; }).sort(function(a, b) { return new Date(a.date) - new Date(b.date); });
        var h = '';
        if (upcoming.length === 0) {
            h = '<div class="no-events">No upcoming events scheduled</div>';
        } else {
            var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            for (var i = 0; i < upcoming.length; i++) {
                var e = upcoming[i];
                var d = new Date(e.date + 'T00:00:00');
                var timeStr = e.time ? 'üïê ' + e.time + ' ¬∑ ' : '';
                h += '<div class="event-item"><div class="event-date-box"><div class="event-month">' + months[d.getMonth()] + '</div><div class="event-day">' + d.getDate() + '</div></div><div class="event-details"><div class="event-title">' + e.title + '<span class="event-type calendar-event ' + e.type + '">' + e.type.replace('-', ' ') + '</span></div><div class="event-meta">' + timeStr + 'üìç ' + e.station + '</div></div></div>';
            }
        }
        list.innerHTML = h;
    }

    function populatePastEventList() {
        var list = document.getElementById('pastEventList');
        var today = new Date();
        var past = calendarEvents.filter(function(e) { return new Date(e.date + 'T00:00:00') < today; }).sort(function(a, b) { return new Date(b.date) - new Date(a.date); });
        var h = '';
        if (past.length === 0) {
            h = '<div class="no-events">No past events with notes yet</div>';
        } else {
            var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            for (var i = 0; i < past.length; i++) {
                var e = past[i];
                var d = new Date(e.date + 'T00:00:00');
                var timeStr = e.time ? 'üïê ' + e.time + ' ¬∑ ' : '';
                h += '<div class="event-item past"><div class="event-date-box"><div class="event-month">' + months[d.getMonth()] + '</div><div class="event-day">' + d.getDate() + '</div></div><div class="event-details"><div class="event-title">' + e.title + '<span class="event-type calendar-event ' + e.type + '">' + e.type.replace('-', ' ') + '</span></div><div class="event-meta">' + timeStr + 'üìç ' + e.station + '</div>';
                if (e.notes) h += '<div class="event-notes"><div class="event-notes-label">üìù Notes</div>' + e.notes + '</div>';
                h += '</div></div>';
            }
        }
        list.innerHTML = h;
    }

    function populateRoundtableActions() {
        var container = document.getElementById('roundtableActions');
        if (allRoundtableActions.length === 0) {
            container.innerHTML = '<div class="no-events">No roundtable actions loaded</div>';
            return;
        }

        var h = '';
        var stationGroups = {};
        allRoundtableActions.forEach(function(a) {
            if (!stationGroups[a.station]) stationGroups[a.station] = [];
            stationGroups[a.station].push(a);
        });

        Object.keys(stationGroups).forEach(function(station) {
            var actions = stationGroups[station];
            h += '<div class="roundtable-section">';
            h += '<div class="roundtable-header"><span class="roundtable-station">' + station + '</span><span class="roundtable-date">' + actions[0].date + ' Roundtable</span></div>';
            actions.forEach(function(a) {
                h += '<div class="action-item-row"><div class="action-checkbox ' + (a.status === 'done' ? 'done' : '') + '"></div><span class="action-owner">' + a.owner + '</span><span class="action-text">' + a.action + '</span><span class="action-status ' + a.status + '">' + a.status + '</span></div>';
            });
            h += '</div>';
        });
        container.innerHTML = h;
    }

    // =========================================================================
    // CHARTS (static data)
    // =========================================================================
    function createCharts() {
        var colors = ['#00ff88', '#00d4ff', '#3742fa', '#a855f7', '#ff4757', '#ffa502', '#ff6b81', '#2ed573', '#1e90ff', '#ff9ff3', '#54a0ff', '#ffd93d'];

        new Chart(document.getElementById('weeklyBarChart'), {
            type: 'bar',
            data: { labels: ['WK1', 'WK2', 'WK3', 'WK4', 'WK5', 'WK6'], datasets: [{ label: 'Kooner WOs', data: [48, 132, 125, 156, 139, 142], backgroundColor: 'rgba(0,255,136,0.7)', borderRadius: 4 }] },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { labels: { color: '#8b8b9a' } } }, scales: { y: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#8b8b9a' } }, x: { grid: { display: false }, ticks: { color: '#8b8b9a' } } } }
        });

        var sortedStations = stationData.slice().sort(function(a, b) { return b.adoption - a.adoption; });
        new Chart(document.getElementById('stationBarChart'), {
            type: 'bar',
            data: { labels: sortedStations.map(function(s) { return s.station; }), datasets: [{ data: sortedStations.map(function(s) { return s.adoption; }), backgroundColor: sortedStations.map(function(s) { return s.adoption >= 85 ? 'rgba(0,255,136,0.7)' : 'rgba(255,71,87,0.7)'; }), borderRadius: 4 }] },
            options: { responsive: true, maintainAspectRatio: false, indexAxis: 'y', plugins: { legend: { display: false } }, scales: { x: { beginAtZero: true, max: 100, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#8b8b9a', callback: function(v) { return v + '%'; } } }, y: { grid: { display: false }, ticks: { color: '#8b8b9a' } } } }
        });

        var weekLabels = ['WK1', 'WK2', 'WK3', 'WK4', 'WK5', 'WK6'];
        var topStations = ['HLA2', 'HDT3', 'HHO3', 'HTP2', 'HCL2', 'HDY1', 'HAU1', 'HSL1'];
        var datasets = topStations.map(function(st, i) {
            var w = weeklyByStation[st];
            return { label: st, data: [w.WK1 || 0, w.WK2 || 0, w.WK3 || 0, w.WK4 || 0, w.WK5 || 0, w.WK6 || 0], backgroundColor: colors[i], borderRadius: 2 };
        });
        new Chart(document.getElementById('stationWeeklyChart'), { type: 'bar', data: { labels: weekLabels, datasets: datasets }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { labels: { color: '#8b8b9a' }, position: 'right' } }, scales: { y: { stacked: true, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#8b8b9a' } }, x: { stacked: true, grid: { display: false }, ticks: { color: '#8b8b9a' } } } } });

        new Chart(document.getElementById('stationRankChart'), { type: 'bar', data: { labels: sortedStations.map(function(s) { return s.station; }), datasets: [{ label: 'Kooner', data: sortedStations.map(function(s) { return s.kooner; }), backgroundColor: 'rgba(0,255,136,0.7)', borderRadius: 2 }, { label: 'Leaked', data: sortedStations.map(function(s) { return s.leaked; }), backgroundColor: 'rgba(255,71,87,0.7)', borderRadius: 2 }] }, options: { responsive: true, maintainAspectRatio: false, indexAxis: 'y', plugins: { legend: { labels: { color: '#8b8b9a' } } }, scales: { x: { stacked: true, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#8b8b9a' } }, y: { stacked: true, grid: { display: false }, ticks: { color: '#8b8b9a' } } } } });

        var leakStations = stationData.filter(function(s) { return s.leaked > 0; }).sort(function(a, b) { return b.leaked - a.leaked; });
        new Chart(document.getElementById('leakageChart'), { type: 'doughnut', data: { labels: leakStations.map(function(s) { return s.station; }), datasets: [{ data: leakStations.map(function(s) { return s.leaked; }), backgroundColor: colors, borderWidth: 0 }] }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'right', labels: { color: '#8b8b9a', padding: 8 } } }, cutout: '60%' } });
    }

    // =========================================================================
    // INITIALIZATION
    // =========================================================================
    document.addEventListener('DOMContentLoaded', function() {
        // Set last updated timestamp
        var now = new Date();
        document.getElementById('lastUpdated').textContent = 'Last Updated: ' + now.toLocaleString('en-US', { year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit' });

        // Static tables and charts
        populateStationQuickTable();
        populateOpportunityTable();
        populateStationFullTable();
        populateStationWeeklyTable();
        populateDSPTable('all');
        populateActionCards();
        populateActionTable();
        createCharts();

        // Load live data
        loadSurveyData();
        loadEventsData();
    });
    </script>
</body>
</html>


